<!DOCTYPE html>
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<link rel="shortcut icon" href="https://chaelist.github.io/assets/images/cat.png" type="image/x-icon">
<link rel="stylesheet" href="https://chaelist.github.io/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-QJ6H6890X3"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QJ6H6890X3'); </script> <script type="text/javascript" src="https://chaelist.github.io/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://chaelist.github.io/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kiva Crowdfunding 2 | chaelist</title>
<meta name="generator" content="Jekyll v4.2.1">
<meta property="og:title" content="Kiva Crowdfunding 2">
<meta property="og:locale" content="en_US">
<meta name="description" content="chaelist’s blog">
<meta property="og:description" content="chaelist’s blog">
<link rel="canonical" href="https://chaelist.github.io/docs/kaggle/kiva_crowdfunding2/">
<meta property="og:url" content="https://chaelist.github.io/docs/kaggle/kiva_crowdfunding2/">
<meta property="og:site_name" content="chaelist">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Kiva Crowdfunding 2"> <script type="application/ld+json"> {"description":"chaelist’s blog","url":"https://chaelist.github.io/docs/kaggle/kiva_crowdfunding2/","@type":"WebPage","headline":"Kiva Crowdfunding 2","@context":"https://schema.org"}</script>
</head>
<body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewbox="0 0 24 24"><title>Link</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"><title>Search</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"><title>Menu</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"><title>Expand</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"><title>Document</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar">
<div class="site-header"> <a href="https://chaelist.github.io/" class="site-title lh-tight"> chaelist </a> <a href="#" id="menu-button" class="site-button"> <svg viewbox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a>
</div>
<nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list">
<li class="nav-list-item"><a href="https://chaelist.github.io/" class="nav-list-link">Home</a></li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/python_basics" class="nav-list-link">Python 기초</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/python_basics/numbers_list_string/" class="nav-list-link">Numbers, List, String</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/python_basics/dictionary_tuple_set/" class="nav-list-link">Dictionary, Tuple, Set</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/python_basics/controlflow/" class="nav-list-link">Control Flow (제어문)</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/python_basics/function_module/" class="nav-list-link">Function &amp; Module</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/data_handling" class="nav-list-link">Data Handling</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/file_input_output/" class="nav-list-link">파일 읽고 쓰기</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/file_folder_handling/" class="nav-list-link">파일 &amp; 폴더 다루기</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/regular_expressions/" class="nav-list-link">Regular Expressions</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/useful_functions/" class="nav-list-link">유용한 Python 내장함수</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/datetime/" class="nav-list-link">Datetime 다루기</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/numpy" class="nav-list-link">Numpy</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/numpy/numpy_basics/" class="nav-list-link">Numpy 기초</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/numpy/numpy_arithmetics/" class="nav-list-link">Numpy 연산과 통계</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/pandas" class="nav-list-link">Pandas</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_basics/" class="nav-list-link">Pandas 기초</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_data_modifying/" class="nav-list-link">Pandas 데이터 가공</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_data_analysis/" class="nav-list-link">Pandas 데이터 분석</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_merge_group/" class="nav-list-link">Pandas 데이터 결합 &amp; 요약</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_str_dt_con/" class="nav-list-link">Pandas str, dt, 조건문</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/visualization" class="nav-list-link">데이터 시각화</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/visualization/pandas_plot/" class="nav-list-link">Pandas plot() 함수</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/visualization/seaborn/" class="nav-list-link">Seaborn</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/visualization/matplotlib/" class="nav-list-link">Matplotlib</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/visualization/plotly/" class="nav-list-link">Plotly</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/webscraping" class="nav-list-link">Web Scraping</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/requests_beautifulsoup/" class="nav-list-link">Requests &amp; BeautifulSoup</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/selenium/" class="nav-list-link">Selenium</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/image_api/" class="nav-list-link">Image 수집 &amp; API 활용</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/twitter_api/" class="nav-list-link">Twitter 데이터 수집</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/app_review/" class="nav-list-link">App Review 수집</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/text_analysis" class="nav-list-link">Text 분석</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/text_analysis/english_text/" class="nav-list-link">빈도 분석 (English)</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/text_analysis/korean_text/" class="nav-list-link">빈도 분석 (한글)</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/network_analysis" class="nav-list-link">Network Analysis</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/network_analysis/network_basics/" class="nav-list-link">Network Analysis 기초</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/network_analysis/social_network/" class="nav-list-link">Social Network Analysis</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/network_analysis/semantic_network/" class="nav-list-link">Semantic Network Analysis</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/ml_basics" class="nav-list-link">Machine Learning 기초</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/linear_regression/" class="nav-list-link">기초 &amp; Linear Regression</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/classification1/" class="nav-list-link">Classification 1</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/classification2/" class="nav-list-link">Classification 2</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/clustering/" class="nav-list-link">Clustering</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/deep_learning/" class="nav-list-link">Deep Learning 기초</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/ml_advanced" class="nav-list-link">Machine Learning 심화</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_advanced/regularization/" class="nav-list-link">Regularization</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_advanced/preprocessing/" class="nav-list-link">데이터 전처리</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_advanced/model_selection/" class="nav-list-link">Model Selection</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/ml_application" class="nav-list-link">Machine Learning 응용</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/sentiment_analysis/" class="nav-list-link">영화 리뷰 감성 분석</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/news_clustering/" class="nav-list-link">뉴스 기사 Clustering</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/time_series/" class="nav-list-link">시계열 데이터 예측</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/topic_modeling/" class="nav-list-link">Topic Modeling (LDA)</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/logistics/" class="nav-list-link">물류 최적화</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/image_processing/" class="nav-list-link">이미지 / 동영상 처리</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/sql" class="nav-list-link">SQL</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/select_basics/" class="nav-list-link">데이터 조회 기초</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/select_advanced/" class="nav-list-link">데이터 조회 심화</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/join_subq_view/" class="nav-list-link">조인, 서브쿼리, 뷰</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/db_table_create/" class="nav-list-link">데이터베이스 &amp; 테이블 구축</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/modify_table/" class="nav-list-link">테이블 가공</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/foreign_key_pymysql/" class="nav-list-link">Foreign Key &amp; Python 연결</a></li>
</ul>
</li>
<li class="nav-list-item active">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/kaggle" class="nav-list-link">Kaggle Dataset EDA</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/youtube_trending/" class="nav-list-link">YouTube Trending Videos</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/amazon_bestsellers/" class="nav-list-link">Amazon Bestselling Books</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/customer_churn/" class="nav-list-link">Telco Customer Churn</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/kiva_crowdfunding/" class="nav-list-link">Kiva Crowdfunding 1</a></li>
<li class="nav-list-item active"><a href="https://chaelist.github.io/docs/kaggle/kiva_crowdfunding2/" class="nav-list-link active">Kiva Crowdfunding 2</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/stem_salaries/" class="nav-list-link">STEM Salaries 1</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/stem_salaries2/" class="nav-list-link">STEM Salaries 2</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/uk_ecommerce/" class="nav-list-link">UK Ecommerce Data 1</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/uk_ecommerce2/" class="nav-list-link">UK Ecommerce Data 2</a></li>
</ul>
</li>
</ul></nav><footer class="site-footer"></footer>
</div>
<div class="main" id="top">
<div id="main-header" class="main-header"><div class="search">
<div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search chaelist" aria-label="Search chaelist" autocomplete="off"> <label for="search-input" class="search-label"><svg viewbox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
</div>
<div id="search-results" class="search-results"></div>
</div></div>
<div id="main-content-wrap" class="main-content-wrap">
<nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list">
<li class="breadcrumb-nav-list-item"><a href="https://chaelist.github.io/docs/kaggle">Kaggle Dataset EDA</a></li>
<li class="breadcrumb-nav-list-item"><span>Kiva Crowdfunding 2</span></li>
</ol></nav><div id="main-content" class="main-content" role="main">
<h1 class="no_toc" id="kiva-crowdfunding-2"> <a href="#kiva-crowdfunding-2" aria-labelledby="kiva-crowdfunding-2" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kiva Crowdfunding 2</h1>
<p><br></p>
<details open=""> <summary class="text-delta"> Table of contents </summary><ol id="markdown-toc">
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EB%A6%AC" id="markdown-toc-데이터-정리">데이터 정리</a></li>
<li>
<a href="#funds-for-philippines" id="markdown-toc-funds-for-philippines">Funds for Philippines</a><ol>
<li><a href="#%EB%B6%84%EA%B8%B0%EB%B3%84-%EC%B6%94%EC%9D%B4" id="markdown-toc-분기별-추이">분기별 추이</a></li>
<li><a href="#borrower-%EC%84%B1%EB%B3%84" id="markdown-toc-borrower-성별">borrower 성별</a></li>
<li><a href="#borrower-%EC%A7%80%EC%97%AD" id="markdown-toc-borrower-지역">borrower 지역</a></li>
<li><a href="#repayment-interval" id="markdown-toc-repayment-interval">repayment interval</a></li>
<li><a href="#%EC%A3%BC%EC%9A%94-sector-activity-use" id="markdown-toc-주요-sector-activity-use">주요 sector, activity, use</a></li>
<li><a href="#use-%EB%8B%A8%EC%96%B4-%EB%B9%88%EB%8F%84-%EB%B6%84%EC%84%9D" id="markdown-toc-use-단어-빈도-분석">‘use’ 단어 빈도 분석</a></li>
</ol>
</li>
<li>
<a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B2%B0%ED%95%A9%ED%95%B4-%EB%B6%84%EC%84%9D" id="markdown-toc-데이터-결합해-분석">데이터 결합해 분석</a><ol>
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EB%A6%AC-1" id="markdown-toc-데이터-정리-1">데이터 정리</a></li>
<li><a href="#kiva%EB%A7%8C%EC%9D%84-%EC%9C%84%ED%95%9C-loan-%EB%B9%84%EC%A4%91-%ED%99%95%EC%9D%B8" id="markdown-toc-kiva만을-위한-loan-비중-확인">kiva만을 위한 loan 비중 확인</a></li>
<li><a href="#country-sector%EB%B3%84-forkiva-%EB%B9%84%EC%A4%91" id="markdown-toc-country-sector별-forkiva-비중">country, sector별 forkiva 비중</a></li>
<li><a href="#field-partner%EC%99%80%EC%9D%98-%ED%98%91%EC%97%85-%EA%B4%80%EA%B3%84-%ED%99%95%EC%9D%B8" id="markdown-toc-field-partner와의-협업-관계-확인">Field Partner와의 협업 관계 확인</a></li>
<li><a href="#%EA%B5%AD%EA%B0%80%EB%B3%84-funded-amount%EC%99%80-mpi" id="markdown-toc-국가별-funded-amount와-mpi">국가별 funded amount와 MPI</a></li>
</ol>
</li>
</ol></details><hr>
<p><strong>*분석 대상 데이터셋: Kiva Crowdfunding Data</strong></p>
<ul>
<li><a href="https://www.kaggle.com/kiva/data-science-for-good-kiva-crowdfunding" target="_blank">데이터셋 출처</a></li>
<li>kiva.org: 세계 각국의 경제적으로 어려운 사람들에게 돈을 빌려주는 online crowdfunding platform</li>
<li>kiva_loans.csv: 2014.01.01~2017.07.26 사이에 kiva에 올라온 loan 정보 데이터. (671,205개의 row)</li>
<li>kiva_mpi_region_locations.csv: 2,772개의 row. 각 지역의 geolocation &amp; poverty level 정보</li>
<li>loan_theme_ids.csv: 779,092개의 row. 각 loan의 theme에 대한 정보.</li>
<li>loan_theme_by_region.csv: 15,736개의 row. 각 loan theme과 연결된 regional 정보들</li>
</ul>
<h2 id="데이터-정리"> <a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EB%A6%AC" aria-labelledby="데이터-정리" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 데이터 정리</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 필요한 라이브러리 import
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="n">stats</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">kiva_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/kiva_loans.csv'</span><span class="p">)</span>
<span class="n">kiva_df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: right">id</th>
<th style="text-align: right">funded_amount</th>
<th style="text-align: right">loan_amount</th>
<th style="text-align: left">activity</th>
<th style="text-align: left">sector</th>
<th style="text-align: left">use</th>
<th style="text-align: left">country_code</th>
<th style="text-align: left">country</th>
<th style="text-align: left">region</th>
<th style="text-align: left">currency</th>
<th style="text-align: right">partner_id</th>
<th style="text-align: left">posted_time</th>
<th style="text-align: left">disbursed_time</th>
<th style="text-align: left">funded_time</th>
<th style="text-align: right">term_in_months</th>
<th style="text-align: right">lender_count</th>
<th style="text-align: left">tags</th>
<th style="text-align: left">borrower_genders</th>
<th style="text-align: left">repayment_interval</th>
<th style="text-align: left">date</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: right">653051</td>
<td style="text-align: right">300</td>
<td style="text-align: right">300</td>
<td style="text-align: left">Fruits &amp; Vegetables</td>
<td style="text-align: left">Food</td>
<td style="text-align: left">To buy seasonal, fresh fruits to sell.</td>
<td style="text-align: left">PK</td>
<td style="text-align: left">Pakistan</td>
<td style="text-align: left">Lahore</td>
<td style="text-align: left">PKR</td>
<td style="text-align: right">247</td>
<td style="text-align: left">2014-01-01 06:12:39+00:00</td>
<td style="text-align: left">2013-12-17 08:00:00+00:00</td>
<td style="text-align: left">2014-01-02 10:06:32+00:00</td>
<td style="text-align: right">12</td>
<td style="text-align: right">12</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">female</td>
<td style="text-align: left">irregular</td>
<td style="text-align: left">2014-01-01</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: right">653053</td>
<td style="text-align: right">575</td>
<td style="text-align: right">575</td>
<td style="text-align: left">Rickshaw</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">to repair and maintain the auto rickshaw used in their business.</td>
<td style="text-align: left">PK</td>
<td style="text-align: left">Pakistan</td>
<td style="text-align: left">Lahore</td>
<td style="text-align: left">PKR</td>
<td style="text-align: right">247</td>
<td style="text-align: left">2014-01-01 06:51:08+00:00</td>
<td style="text-align: left">2013-12-17 08:00:00+00:00</td>
<td style="text-align: left">2014-01-02 09:17:23+00:00</td>
<td style="text-align: right">11</td>
<td style="text-align: right">14</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">female, female</td>
<td style="text-align: left">irregular</td>
<td style="text-align: left">2014-01-01</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: right">653068</td>
<td style="text-align: right">150</td>
<td style="text-align: right">150</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">To repair their old cycle-van and buy another one to rent out as a source of income</td>
<td style="text-align: left">IN</td>
<td style="text-align: left">India</td>
<td style="text-align: left">Maynaguri</td>
<td style="text-align: left">INR</td>
<td style="text-align: right">334</td>
<td style="text-align: left">2014-01-01 09:58:07+00:00</td>
<td style="text-align: left">2013-12-17 08:00:00+00:00</td>
<td style="text-align: left">2014-01-01 16:01:36+00:00</td>
<td style="text-align: right">43</td>
<td style="text-align: right">6</td>
<td style="text-align: left">user_favorite, user_favorite</td>
<td style="text-align: left">female</td>
<td style="text-align: left">bullet</td>
<td style="text-align: left">2014-01-01</td>
</tr>
<tr>
<td style="text-align: right">3</td>
<td style="text-align: right">653063</td>
<td style="text-align: right">200</td>
<td style="text-align: right">200</td>
<td style="text-align: left">Embroidery</td>
<td style="text-align: left">Arts</td>
<td style="text-align: left">to purchase an embroidery machine and a variety of new embroidery materials.</td>
<td style="text-align: left">PK</td>
<td style="text-align: left">Pakistan</td>
<td style="text-align: left">Lahore</td>
<td style="text-align: left">PKR</td>
<td style="text-align: right">247</td>
<td style="text-align: left">2014-01-01 08:03:11+00:00</td>
<td style="text-align: left">2013-12-24 08:00:00+00:00</td>
<td style="text-align: left">2014-01-01 13:00:00+00:00</td>
<td style="text-align: right">11</td>
<td style="text-align: right">8</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">female</td>
<td style="text-align: left">irregular</td>
<td style="text-align: left">2014-01-01</td>
</tr>
<tr>
<td style="text-align: right">4</td>
<td style="text-align: right">653084</td>
<td style="text-align: right">400</td>
<td style="text-align: right">400</td>
<td style="text-align: left">Milk Sales</td>
<td style="text-align: left">Food</td>
<td style="text-align: left">to purchase one buffalo.</td>
<td style="text-align: left">PK</td>
<td style="text-align: left">Pakistan</td>
<td style="text-align: left">Abdul Hakeem</td>
<td style="text-align: left">PKR</td>
<td style="text-align: right">245</td>
<td style="text-align: left">2014-01-01 11:53:19+00:00</td>
<td style="text-align: left">2013-12-17 08:00:00+00:00</td>
<td style="text-align: left">2014-01-01 19:18:51+00:00</td>
<td style="text-align: right">14</td>
<td style="text-align: right">16</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">female</td>
<td style="text-align: left">monthly</td>
<td style="text-align: left">2014-01-01</td>
</tr>
</tbody>
</table></div></div>
<ul>
<li>funded_amount: amount disbursed by Kiva to the field agent (USD)</li>
<li>loan_amount: amount disbursed by the field agent to the borrower<ul>
<li>funded_amount &lt; loan_amount인 경우: 48328건</li>
<li>funded_amount &gt; loan_amount인 경우: 2건</li>
</ul>
</li>
<li>country_code: ISO country code</li>
<li>posted_time: the time at which the loan is posted on Kiva by the field agent</li>
<li>disbursed_time: the time at which the loan is disbursed by the field agent to the borrower</li>
<li>funded_time: the time at which the loan posted to Kiva gets funded by lenders completely<ul><li>null값: 48331개 (funded_amount &gt;= loan_amount인 경우 중 3건도 funded_time이 null로 나옴…)</li></ul>
</li>
<li>term_in_months: the duration for which the loan was disbursed in months</li>
<li>date: posted_time에서 date만 추출한 것. (Kiva에 올라온 날짜)</li>
</ul>
<ol>
<li>
<p>datetime 데이터 정리</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># datetime 형식 변환
</span> <span class="n">kiva_df</span><span class="p">[</span><span class="s">'posted_time'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">kiva_df</span><span class="p">[</span><span class="s">'posted_time'</span><span class="p">])</span>
 <span class="n">kiva_df</span><span class="p">[</span><span class="s">'disbursed_time'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">kiva_df</span><span class="p">[</span><span class="s">'disbursed_time'</span><span class="p">])</span>
 <span class="n">kiva_df</span><span class="p">[</span><span class="s">'funded_time'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">kiva_df</span><span class="p">[</span><span class="s">'funded_time'</span><span class="p">])</span>

 <span class="c1"># posted_time -&gt; Month, Quarter 단위로 저장해둠
</span> <span class="n">kiva_df</span><span class="p">[</span><span class="s">'posted_month'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kiva_df</span><span class="p">[</span><span class="s">'posted_time'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y%m'</span><span class="p">)</span>
 <span class="n">kiva_df</span><span class="p">[</span><span class="s">'posted_quarter'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kiva_df</span><span class="p">[</span><span class="s">'posted_time'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">to_period</span><span class="p">(</span><span class="s">"Q"</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="s">'str'</span><span class="p">)</span>
</code></pre></div></div>
</li>
<li>
<p>borrower type 정리</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">## borrower를 성별 / 단체 유무로 정리
</span> <span class="k">def</span> <span class="nf">borrower_type</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
     <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
         <span class="n">borrower</span> <span class="o">=</span> <span class="s">'N/A'</span>
     <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s">'female'</span><span class="p">:</span>
         <span class="n">borrower</span> <span class="o">=</span> <span class="s">'female'</span>
     <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s">'male'</span><span class="p">:</span>
         <span class="n">borrower</span> <span class="o">=</span> <span class="s">'male'</span>
     <span class="k">else</span><span class="p">:</span>
         <span class="n">borr_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">', '</span><span class="p">))</span>
         <span class="k">if</span> <span class="s">'female'</span> <span class="ow">in</span> <span class="n">borr_set</span><span class="p">:</span>
             <span class="k">if</span> <span class="s">'male'</span> <span class="ow">in</span> <span class="n">borr_set</span><span class="p">:</span>
                 <span class="n">borrower</span> <span class="o">=</span> <span class="s">'mixed_group'</span>
             <span class="k">else</span><span class="p">:</span>
                 <span class="n">borrower</span> <span class="o">=</span> <span class="s">'female_group'</span>
         <span class="k">else</span><span class="p">:</span>
             <span class="n">borrower</span> <span class="o">=</span> <span class="s">'male_group'</span>
     <span class="k">return</span> <span class="n">borrower</span>

 <span class="n">kiva_df</span><span class="p">[</span><span class="s">'borrower_type'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kiva_df</span><span class="p">[</span><span class="s">'borrower_genders'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">borrower_type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></div>
</li>
</ol>
<h2 id="funds-for-philippines"> <a href="#funds-for-philippines" aria-labelledby="funds-for-philippines" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Funds for Philippines</h2>
<p>: kiva를 통해 받은 funding 금액이 가장 많은 국가인 Philippines에 대해 집중 탐구</p>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding8.png" alt="loan_per_country"></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># philippines 데이터만 따로 추출
</span><span class="n">ph_df</span> <span class="o">=</span> <span class="n">kiva_df</span><span class="p">[</span><span class="n">kiva_df</span><span class="p">[</span><span class="s">'country'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Philippines'</span><span class="p">]</span>

<span class="n">ph_df</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 160441 entries, 51 to 670445
Data columns (total 23 columns):
 #   Column              Non-Null Count   Dtype              
---  ------              --------------   -----              
 0   id                  160441 non-null  int64              
 1   funded_amount       160441 non-null  float64            
 2   loan_amount         160441 non-null  float64            
 3   activity            160441 non-null  object             
 4   sector              160441 non-null  object             
 5   use                 160361 non-null  object             
 6   country_code        160441 non-null  object             
 7   country             160441 non-null  object             
 8   region              160360 non-null  object             
 9   currency            160441 non-null  object             
 10  partner_id          160441 non-null  float64            
 11  posted_time         160441 non-null  datetime64[ns, UTC]
 12  disbursed_time      160441 non-null  datetime64[ns, UTC]
 13  funded_time         157607 non-null  datetime64[ns, UTC]
 14  term_in_months      160441 non-null  float64            
 15  lender_count        160441 non-null  int64              
 16  tags                94094 non-null   object             
 17  borrower_genders    160361 non-null  object             
 18  repayment_interval  160441 non-null  object             
 19  date                160441 non-null  object             
 20  posted_quarter      160441 non-null  object             
 21  borrower_type       160441 non-null  object             
 22  posted_month        160441 non-null  object             
dtypes: datetime64[ns, UTC](3), float64(4), int64(2), object(14)
memory usage: 29.4+ MB
</code></pre></div></div>
<h3 id="분기별-추이"> <a href="#%EB%B6%84%EA%B8%B0%EB%B3%84-%EC%B6%94%EC%9D%B4" aria-labelledby="분기별-추이" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 분기별 추이</h3>
<ol>
<li>
<p>분기별 loan count</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
 <span class="c1"># 2017Q3은 2017.07.26까지의 기록밖에 없으므로 제외하고 시각화
</span> <span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">[</span><span class="n">ph_df</span><span class="p">[</span><span class="s">'posted_quarter'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'2017Q3'</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">'posted_quarter'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> 
             <span class="n">estimator</span><span class="o">=</span><span class="s">'count'</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#C88686'</span><span class="p">)</span>
 <span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">18000</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_1.png" alt="loan_count_ph"></p>
</li>
<li>
<p>분기별 평균 funded_amount</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">[</span><span class="n">ph_df</span><span class="p">[</span><span class="s">'posted_quarter'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'2017Q3'</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">'posted_quarter'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#C88686'</span><span class="p">)</span>
 <span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">450</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_2.png" alt="avg_funded_amount_ph"></p>
</li>
<li>
<p>분기별 총 funded_amount</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">[</span><span class="n">ph_df</span><span class="p">[</span><span class="s">'posted_quarter'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'2017Q3'</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">'posted_quarter'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> 
             <span class="n">estimator</span><span class="o">=</span><span class="s">'sum'</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#C88686'</span><span class="p">)</span>
 <span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">1500000</span><span class="p">,</span> <span class="mi">5500000</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_3.png" alt="total_funded_amount_ph"></p>
<ul><li>2014년 이후 post당 평균 funded_amount는 줄고 있지만, 올라온 loan post 수 자체가 계속 증가세를 보임에 따라 총 funded_amount도 증가 추세.</li></ul>
</li>
</ol>
<h3 id="borrower-성별"> <a href="#borrower-%EC%84%B1%EB%B3%84" aria-labelledby="borrower-성별" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> borrower 성별</h3>
<ol>
<li>
<p>borrower type별 loan count</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'borrower_type'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_4.png" alt="loan_count_per_borrower_type_ph"></p>
<ul>
<li>여러 borrower가 그룹으로 빌리는 경우는 없음 (female_group, male_group, mixed_group)</li>
<li>female 혼자 빌리는 경우가 압도적 (전체 loan의 약 95%)</li>
</ul>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'borrower_type'</span><span class="p">)[</span><span class="s">'funded_amount'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> borrower_type
 N/A           80
 female    151984
 male        8377
 Name: funded_amount, dtype: int64
</code></pre></div></div>
</li>
<li>
<p>borrower type별 평균 funded amount</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'borrower_type'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_5.png" alt="funded_amount_per_borrower_type_ph"></p>
<ul><li>평균 funded amount는 오히려 female이 많은 편은 아님</li></ul>
</li>
<li>
<p>분기별 총 funded amount 비교</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">[</span><span class="n">ph_df</span><span class="p">[</span><span class="s">'posted_quarter'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'2017Q3'</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">'posted_quarter'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> 
             <span class="n">hue</span><span class="o">=</span><span class="s">'borrower_type'</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="s">'sum'</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_6.png" alt="quarterly_funded_amount_per_borrower_type_ph"></p>
<ul>
<li>총 funded amount 자체도 female이 모든 기간에 가장 압도적.</li>
<li>female borrower를 중심으로 funded_amount가 크게 증가세</li>
</ul>
</li>
</ol>
<h3 id="borrower-지역"> <a href="#borrower-%EC%A7%80%EC%97%AD" aria-labelledby="borrower-지역" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> borrower 지역</h3>
<ol>
<li>
<p>funded_amount Top 10 지역</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">ph_region</span> <span class="o">=</span> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'region'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>
 <span class="n">ph_region</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="c1"># Top 10까지만 시각화
</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_region</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'region'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_7.png" alt="region_funded_amount_ph"></p>
<ul><li>Palawan과 Negros Occidental의 지역들이 상위권에 많이 포진되어 있음</li></ul>
<p class="fs-1 lh-0"> </p>
</li>
<li>region의 뒷부분을 따로 ‘province’로 저장<ul><li>region에 적힌 구조가 대체로 ‘Narra, Palawan’처럼 ‘municipality, province’의 구조로 되어 있다고 생각해, 쉼표(,) 뒷부분을 분리해서 저장</li></ul>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># 쉼표가 없는 region명이 몇 개인지 확인
</span> <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ph_region</span><span class="p">))</span>
 <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ph_region</span><span class="p">[</span><span class="n">ph_region</span><span class="p">[</span><span class="s">'region'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s">','</span><span class="p">)]))</span>  
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 3638
 3249
</code></pre></div></div>
<p>→ 쉼표로 분리된 region명이 대부분이므로, 쉼표를 기준으로 나누기로 함.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># 쉼표(,)를 기준으로 뒷부분 반을 province로 저장하고, 쉼표 없이 하나가 통째로 region명인 경우 그대로 province에 저장.
</span>
 <span class="n">ph_region_temp</span> <span class="o">=</span> <span class="n">ph_region</span><span class="p">[</span><span class="s">'region'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ph_region_temp</span><span class="p">.</span><span class="n">index</span><span class="p">:</span>
     <span class="k">if</span> <span class="n">ph_region_temp</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>   <span class="c1">## 1이 None이 아니면 실행됨 (None이면 else로)
</span>         <span class="n">ph_region</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'province'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ph_region_temp</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
     <span class="k">else</span><span class="p">:</span>
         <span class="n">ph_region</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'province'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ph_region_temp</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

 <span class="n">ph_region</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: left">region</th>
<th style="text-align: right">funded_amount</th>
<th style="text-align: left">province</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">2000</td>
<td style="text-align: left">Narra, Palawan</td>
<td style="text-align: right">1234625.0</td>
<td style="text-align: left">Palawan</td>
</tr>
<tr>
<td style="text-align: right">2556</td>
<td style="text-align: left">Quezon, Palawan</td>
<td style="text-align: right">1210875.0</td>
<td style="text-align: left">Palawan</td>
</tr>
<tr>
<td style="text-align: right">583</td>
<td style="text-align: left">Brookes Point, Palawan</td>
<td style="text-align: right">1180100.0</td>
<td style="text-align: left">Palawan</td>
</tr>
<tr>
<td style="text-align: right">1381</td>
<td style="text-align: left">Kabankalan, Negros Occidental</td>
<td style="text-align: right">1040700.0</td>
<td style="text-align: left">Negros Occidental</td>
</tr>
<tr>
<td style="text-align: right">1282</td>
<td style="text-align: left">Hinigaran, Negros Occidental</td>
<td style="text-align: right">956950.0</td>
<td style="text-align: left">Negros Occidental</td>
</tr>
</tbody>
</table></div></div>
</li>
<li>
<p>province별 funded_amount 정리, 비교</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">ph_province</span> <span class="o">=</span> <span class="n">ph_region</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'province'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>
 <span class="n">ph_province</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="c1"># Top 10까지만 시각화
</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_province</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'province'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_8.png" alt="province_funded_amount_ph"></p>
<ul><li>Negros Occidental이 가장 압도적</li></ul>
</li>
<li>
<p>각 province별로, 어떤 sector의 funded_amount가 많은지 확인</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># ph_df에 'province' 칼럼를 더해줌
</span> <span class="n">ph_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ph_df</span><span class="p">,</span> <span class="n">ph_region</span><span class="p">[[</span><span class="s">'region'</span><span class="p">,</span> <span class="s">'province'</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'region'</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># funded amount Top 10 province만 따로 저장
</span> <span class="n">top_countries</span> <span class="o">=</span> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'province'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">index</span>

 <span class="c1"># funded amount 내림차순으로 sector 순서 정렬
</span> <span class="n">sectors_order</span> <span class="o">=</span> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'sector'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">index</span>

 <span class="n">loans_province_sector</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">ph_df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s">'province'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'sector'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'sum'</span><span class="p">)</span>
 <span class="n">loans_province_sector</span> <span class="o">=</span> <span class="n">loans_province_sector</span><span class="p">[</span><span class="n">loans_province_sector</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top_countries</span><span class="p">)]</span>  <span class="c1"># top 10 province만 대상으로 자름
</span> <span class="n">loans_province_sector</span> <span class="o">=</span> <span class="n">loans_province_sector</span><span class="p">[</span><span class="n">sectors_order</span><span class="p">]</span>   <span class="c1"># 전체 loan amount가 가장 높은 sector부터 내림차순 정렬
</span>
 <span class="n">loans_province_sector</span> <span class="o">=</span> <span class="n">loans_province_sector</span><span class="p">.</span><span class="n">T</span>
 <span class="n">loans_province_sector</span> <span class="o">=</span> <span class="n">loans_province_sector</span><span class="p">[</span><span class="n">top_countries</span><span class="p">]</span>   <span class="c1"># 전체 loan amount가 가장 높은 province부터 내림차순 정렬
</span>

 <span class="c1"># heatmap으로 시각화
</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">loans_province_sector</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'pink_r'</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">'.0f'</span><span class="p">)</span>
 <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">40</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_9.png" alt="province_sector_funded_amount_ph"></p>
<ul>
<li>Negros Occidental은 Retail sector로 빌린 금액이 가장 많음</li>
<li>Palawan은 Retail과 Food sector가 비슷하게 많음</li>
<li>Negros Occidental과 Negros Oriental은 Agriculture sector로 빌린 금액도 많은 편</li>
</ul>
</li>
</ol>
<h3 id="repayment-interval"> <a href="#repayment-interval" aria-labelledby="repayment-interval" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> repayment interval</h3>
<ol>
<li>
<p>repayment interval별 총 funded_amount</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'repayment_interval'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> 
             <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_10.png" alt="repayment_interval_funded_amount_ph"></p>
</li>
<li>
<p>repayment interval별 평균 funded_amount</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'repayment_interval'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_11.png" alt="repayment_interval_avg_funded_amount_ph"></p>
</li>
<li>
<p>repayment interval별 loan 수</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'repayment_interval'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_12.png" alt="repayment_interval_loans_ph"></p>
<ul>
<li>irregular 상환 방식의 loan이 가장 많음</li>
<li>irregular 상환 방식의 loan이 평균 funded amount가 많은 편은 아니지만, 수 자체가 압도적이기 때문에 전체 funded amount 중 irregular 상환 방식인 금액이 압도적</li>
<li>전체 kiva loan 중에서는 monthly로 상환되는 금액이 가장 많은 것을 생각하면, irregular 상환 금액이 많다는 것은 Philippines의 특징인 듯</li>
</ul>
</li>
<li>
<p>분기별 repayment interval별 funded amount</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">quarter_interval</span> <span class="o">=</span> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'posted_quarter'</span><span class="p">,</span> <span class="s">'repayment_interval'</span><span class="p">])[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>
 <span class="n">quarter_interval</span> <span class="o">=</span> <span class="n">quarter_interval</span><span class="p">[</span><span class="n">quarter_interval</span><span class="p">[</span><span class="s">'posted_quarter'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'2017Q3'</span><span class="p">]</span>

 <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">quarter_interval</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'posted_quarter'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'repayment_interval'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">,</span>
             <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s">'irregular'</span><span class="p">,</span> <span class="s">'monthly'</span><span class="p">,</span> <span class="s">'bullet'</span><span class="p">])</span>

 <span class="c1"># legend를 box 밖으로 빼 줌
</span> <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_13.png" alt="quarterly_repayment_interval_funded_amount_ph"></p>
<ul>
<li>irregular 상환 방식의 금액이 가장 많이 증가하는 추세</li>
<li>irregular 상환보다는 monthly 상환이 더 안정적인 자금 계획에 유리하므로, irregular 상환 방식보다는 monthly 상환 방식을 늘리는 것이 좋다고 생각됨</li>
</ul>
</li>
</ol>
<h3 id="주요-sector-activity-use"> <a href="#%EC%A3%BC%EC%9A%94-sector-activity-use" aria-labelledby="주요-sector-activity-use" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 주요 sector, activity, use</h3>
<ol>
<li>
<p>sector별 funded amount</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># funded amount 순으로 내림차순 정렬해 시각화
</span> <span class="n">ph_sectors</span> <span class="o">=</span> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'sector'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>

 <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_sectors</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'sector'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">)</span>
 <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">40</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_14.png" alt="funded_amount_sector_ph"></p>
<ul><li>Retail, Food, Agriculture 관련 funded amount가 가장 많음</li></ul>
</li>
<li>
<p>funded amount Top 10 activities</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">ph_activities</span> <span class="o">=</span> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'activity'</span><span class="p">,</span> <span class="s">'sector'</span><span class="p">])[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>
 <span class="n">ph_activities</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: left">activity</th>
<th style="text-align: left">sector</th>
<th style="text-align: right">funded_amount</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: left">General Store</td>
<td style="text-align: left">Retail</td>
<td style="text-align: right">15025550.0</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: left">Pigs</td>
<td style="text-align: left">Agriculture</td>
<td style="text-align: right">6039975.0</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: left">Farming</td>
<td style="text-align: left">Agriculture</td>
<td style="text-align: right">4063150.0</td>
</tr>
<tr>
<td style="text-align: right">3</td>
<td style="text-align: left">Fishing</td>
<td style="text-align: left">Food</td>
<td style="text-align: right">3129675.0</td>
</tr>
<tr>
<td style="text-align: right">4</td>
<td style="text-align: left">Fish Selling</td>
<td style="text-align: left">Food</td>
<td style="text-align: right">2969850.0</td>
</tr>
<tr>
<td style="text-align: right">5</td>
<td style="text-align: left">Food Production/Sales</td>
<td style="text-align: left">Food</td>
<td style="text-align: right">2659425.0</td>
</tr>
<tr>
<td style="text-align: right">6</td>
<td style="text-align: left">Personal Housing Expenses</td>
<td style="text-align: left">Housing</td>
<td style="text-align: right">1710425.0</td>
</tr>
<tr>
<td style="text-align: right">7</td>
<td style="text-align: left">Fruits &amp; Vegetables</td>
<td style="text-align: left">Food</td>
<td style="text-align: right">1563675.0</td>
</tr>
<tr>
<td style="text-align: right">8</td>
<td style="text-align: left">Retail</td>
<td style="text-align: left">Retail</td>
<td style="text-align: right">1366075.0</td>
</tr>
<tr>
<td style="text-align: right">9</td>
<td style="text-align: left">Motorcycle Transport</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: right">1067450.0</td>
</tr>
</tbody>
</table></div></div>
<p>→ Top 10 activities 시각화</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_activities</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'activity'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_15.png" alt="funded_amount_activity_ph"></p>
<ul>
<li>‘Retail’ sector의 ‘General Store’ 목적의 funded amount가 압도적으로 많고, 그 다음은 오히려 ‘Agriculture’ sector의 ‘Pigs’와 ‘Farming’ 목적의 funded amount가 많음</li>
<li>여러 섬으로 구성된 국가인만큼, ‘Food’ sector 중에서는 ‘Fishing’과 ‘Fish Selling’ 목적의 funded amount가 많음</li>
</ul>
</li>
<li>
<p>funded amount Top 10 use</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">ph_use</span> <span class="o">=</span> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'use'</span><span class="p">])[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>

 <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_use</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'use'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_16.png" alt="funded_amount_use_ph"></p>
<ul><li>같은 내용이라도 사용한 단어에 따라 다르게 집계되므로 정확히 파악하기 어렵지만, ‘grocery’, ‘pig’, ‘food production business’ 등의 단어들이 눈에 띔</li></ul>
</li>
<li>
<p>‘General Store’ 관련 Top 10 use</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># 우선, activity, sector, use별 funded amount를 정리
</span> <span class="n">ph_use_activity</span> <span class="o">=</span> <span class="n">ph_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'use'</span><span class="p">,</span> <span class="s">'activity'</span><span class="p">,</span> <span class="s">'sector'</span><span class="p">])[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>
 <span class="n">ph_use_activity</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: left">use</th>
<th style="text-align: left">activity</th>
<th style="text-align: left">sector</th>
<th style="text-align: right">funded_amount</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: left">to purchase more groceries to sell.</td>
<td style="text-align: left">General Store</td>
<td style="text-align: left">Retail</td>
<td style="text-align: right">501400.0</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: left">to buy feed and other supplies to raise her pigs.</td>
<td style="text-align: left">Pigs</td>
<td style="text-align: left">Agriculture</td>
<td style="text-align: right">431850.0</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: left">to buy fertilizers and other farm supplies.</td>
<td style="text-align: left">Farming</td>
<td style="text-align: left">Agriculture</td>
<td style="text-align: right">427725.0</td>
</tr>
<tr>
<td style="text-align: right">3</td>
<td style="text-align: left">to buy feed and vitamins for her pigs.</td>
<td style="text-align: left">Pigs</td>
<td style="text-align: left">Agriculture</td>
<td style="text-align: right">374800.0</td>
</tr>
<tr>
<td style="text-align: right">4</td>
<td style="text-align: left">to buy ingredients for her food production business</td>
<td style="text-align: left">Food Production/Sales</td>
<td style="text-align: left">Food</td>
<td style="text-align: right">344125.0</td>
</tr>
</tbody>
</table></div></div>
<p>→ ‘General Store’ Top 10 use 시각화</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ph_use_activity</span><span class="p">[</span><span class="n">ph_use_activity</span><span class="p">[</span><span class="s">'activity'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'General Store'</span><span class="p">].</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'use'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_17.png" alt="funded_amount_use_general_store_ph"></p>
<ul><li>같은 내용이라도 사용한 단어에 따라 다르게 집계되므로 정확히 파악하기 어렵지만, General Store를 위한 fund로는 ‘grocery 구매’ 관련 목적이 많다고 생각됨</li></ul>
</li>
</ol>
<h3 id="use-단어-빈도-분석"> <a href="#use-%EB%8B%A8%EC%96%B4-%EB%B9%88%EB%8F%84-%EB%B6%84%EC%84%9D" aria-labelledby="use-단어-빈도-분석" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ‘use’ 단어 빈도 분석</h3>
<ul>
<li>‘use’는 같은 내용이라도 단어 사용 등에 따라 다르게 집계되므로, 단순 집계 후 시각화보다 단어별로 쪼개서 파악하는 것이 도움이 될 수 있다고 생각</li>
<li>사유를 단어별로 나눠서 분석해, 어떤 단어가 빈번하게 등장하는지 확인하고, 이로부터 필리핀의 전반적인 loan needs를 파악</li>
</ul>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## 단어 빈도 계산 &amp;  wordcloud 생성 &amp; 빈번하게 사용된 단어 bar graph로 시각화하는 코드를 미리 함수로 다 만들어 둠
## 각 loan의 funded amount는 고려하지 않고, count만 고려
</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>


<span class="c1"># wordcloud mask 
</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">ogrid</span><span class="p">[:</span><span class="mi">1200</span><span class="p">,</span> <span class="p">:</span><span class="mi">1200</span><span class="p">]</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">600</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">600</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">520</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">mask</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">*</span> <span class="n">mask</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">count_words</span><span class="p">(</span><span class="n">sector_name</span><span class="p">):</span>
    <span class="c1"># Text Cleaning &amp; Case Conversion &amp; Tokenization
</span>    <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">ph_df</span><span class="p">[</span><span class="n">ph_df</span><span class="p">[</span><span class="s">'sector'</span><span class="p">]</span> <span class="o">==</span> <span class="n">sector_name</span><span class="p">][</span><span class="s">'use'</span><span class="p">]:</span>
        <span class="n">content_cleaned</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">content</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'.'</span><span class="p">,</span> <span class="s">''</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">','</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">().</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># ., 정도만 제거, strip, lower 
</span>        <span class="n">words</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">content_cleaned</span><span class="p">.</span><span class="n">split</span><span class="p">())</span>  <span class="c1"># 간단하게 공백 기준으로만 쪼개줌
</span>
    <span class="c1"># POS Tagging
</span>    <span class="n">tokens_pos</span> <span class="o">=</span> <span class="n">nltk</span><span class="p">.</span><span class="n">pos_tag</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>  

    <span class="c1"># Noun, Verb만 추출 &amp; Lemmatization
</span>    <span class="n">wlem</span> <span class="o">=</span> <span class="n">nltk</span><span class="p">.</span><span class="n">WordNetLemmatizer</span><span class="p">()</span>
    <span class="n">lemm_words</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">tokens_pos</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="s">'NN'</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s">'VB'</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">):</span>
            <span class="n">lemm_words</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">wlem</span><span class="p">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>

    <span class="c1"># Counter로 빈도 계산
</span>    <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">lemm_words</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>


<span class="k">def</span> <span class="nf">generate_wordcloud</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="c1"># generate wordcloud
</span>    <span class="n">wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">relative_scaling</span><span class="o">=</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">background_color</span><span class="o">=</span><span class="s">'white'</span><span class="p">,</span>
                         <span class="n">colormap</span><span class="o">=</span><span class="s">'pink'</span><span class="p">,</span>
                         <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">).</span><span class="n">generate_from_frequencies</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">visualize_top10_words</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="n">word_count</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s">'index'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'count'</span><span class="p">]).</span><span class="n">reset_index</span><span class="p">().</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'index'</span><span class="p">:</span><span class="s">'word'</span><span class="p">})</span>
    <span class="n">word_count</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'count'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">word_count</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s">'count'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'word'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">)</span>
</code></pre></div></div>
<ol>
<li>
<p>Retail sector의 use</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">retail_c</span> <span class="o">=</span> <span class="n">count_words</span><span class="p">(</span><span class="s">'Retail'</span><span class="p">)</span>
 <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">retail_c</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_18.png" alt="retail_use_wordcloud_ph" width="300"></p>
<ul><li>canned goods, grocery 등의 item들을 사기 위한 목적이 많다고 파악됨</li></ul>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">visualize_top10_words</span><span class="p">(</span><span class="n">retail_c</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_19.png" alt="retail_use_bargraph_ph"></p>
</li>
<li>
<p>Food sector의 use</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">food_c</span> <span class="o">=</span> <span class="n">count_words</span><span class="p">(</span><span class="s">'Food'</span><span class="p">)</span>
 <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">food_c</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_20.png" alt="food_use_wordcloud_ph" width="300"></p>
<ul><li>‘food’ sector도 단순히 자신의 식량을 사기 위한 것보다, ‘food production business’의 재료 구매 &amp; 판매할 식료품 구매 목적이 많다고 판단됨</li></ul>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">visualize_top10_words</span><span class="p">(</span><span class="n">food_c</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_21.png" alt="food_use_bargraph_ph"></p>
</li>
<li>
<p>Agriculture sector의 use</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">agri_c</span> <span class="o">=</span> <span class="n">count_words</span><span class="p">(</span><span class="s">'Agriculture'</span><span class="p">)</span>
 <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">agri_c</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_22.png" alt="agri_use_wordcloud_ph" width="300"></p>
<ul>
<li>pig를 위한 식량 등을 구매하는 목적이 많고, 그 다음으로는 농업을 위한 fertilizer 등의 구매 목적도 많다고 판단됨</li>
<li>돼지 농장이 필리핀의 주요 business 중 하나라고 추정됨</li>
</ul>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">visualize_top10_words</span><span class="p">(</span><span class="n">agri_c</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_23.png" alt="agri_use_bargraph_ph"></p>
</li>
</ol>
<h2 id="데이터-결합해-분석"> <a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B2%B0%ED%95%A9%ED%95%B4-%EB%B6%84%EC%84%9D" aria-labelledby="데이터-결합해-분석" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 데이터 결합해 분석</h2>
<h3 id="데이터-정리-1"> <a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EB%A6%AC-1" aria-labelledby="데이터-정리-1" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 데이터 정리</h3>
<ol>
<li>
<p>kiva_mpi_region_locations.csv</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">location_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/kiva_mpi_region_locations.csv'</span><span class="p">)</span>
 <span class="n">location_df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: left">LocationName</th>
<th style="text-align: left">ISO</th>
<th style="text-align: left">country</th>
<th style="text-align: left">region</th>
<th style="text-align: left">world_region</th>
<th style="text-align: right">MPI</th>
<th style="text-align: left">geo</th>
<th style="text-align: right">lat</th>
<th style="text-align: right">lon</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: left">Badakhshan, Afghanistan</td>
<td style="text-align: left">AFG</td>
<td style="text-align: left">Afghanistan</td>
<td style="text-align: left">Badakhshan</td>
<td style="text-align: left">South Asia</td>
<td style="text-align: right">0.387</td>
<td style="text-align: left">(36.7347725, 70.81199529999999)</td>
<td style="text-align: right">36.7348</td>
<td style="text-align: right">70.812</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: left">Badghis, Afghanistan</td>
<td style="text-align: left">AFG</td>
<td style="text-align: left">Afghanistan</td>
<td style="text-align: left">Badghis</td>
<td style="text-align: left">South Asia</td>
<td style="text-align: right">0.466</td>
<td style="text-align: left">(35.1671339, 63.7695384)</td>
<td style="text-align: right">35.1671</td>
<td style="text-align: right">63.7695</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: left">Baghlan, Afghanistan</td>
<td style="text-align: left">AFG</td>
<td style="text-align: left">Afghanistan</td>
<td style="text-align: left">Baghlan</td>
<td style="text-align: left">South Asia</td>
<td style="text-align: right">0.3</td>
<td style="text-align: left">(35.8042947, 69.2877535)</td>
<td style="text-align: right">35.8043</td>
<td style="text-align: right">69.2878</td>
</tr>
</tbody>
</table></div></div>
<ul>
<li>ISO: unique ID for country</li>
<li>MPI: multidimensional poverty index – 수치가 높을수록 poverty level이 높은 것</li>
</ul>
<p>→ 중복값 제거</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">print</span><span class="p">(</span><span class="s">'중복 제거 이전: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">location_df</span><span class="p">))</span>

 <span class="n">location_df</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
 <span class="k">print</span><span class="p">(</span><span class="s">'중복 제거 이후: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">location_df</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 중복 제거 이전:  2772
 중복 제거 이후:  1009
</code></pre></div></div>
<p>→ LocationName이 null값인 행 제외 (LocationName이 null이면 region, MPI도 다 null임)</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">print</span><span class="p">(</span><span class="s">'결측치 제거 이전: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">location_df</span><span class="p">))</span>

 <span class="n">location_df</span> <span class="o">=</span> <span class="n">location_df</span><span class="p">[</span><span class="o">~</span><span class="n">location_df</span><span class="p">[</span><span class="s">'LocationName'</span><span class="p">].</span><span class="n">isna</span><span class="p">()]</span>
 <span class="n">location_df</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="k">print</span><span class="p">(</span><span class="s">'결측치 제거 이후: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">location_df</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 결측치 제거 이전:  1009
 결측치 제거 이후:  984
</code></pre></div></div>
</li>
<li>
<p>loan_theme_ids.csv</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">loan_themes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/loan_theme_ids.csv'</span><span class="p">)</span>
 <span class="n">loan_themes_df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: right">id</th>
<th style="text-align: left">Loan Theme ID</th>
<th style="text-align: left">Loan Theme Type</th>
<th style="text-align: right">Partner ID</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: right">638631</td>
<td style="text-align: left">a1050000000skGl</td>
<td style="text-align: left">General</td>
<td style="text-align: right">151</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: right">640322</td>
<td style="text-align: left">a1050000000skGl</td>
<td style="text-align: left">General</td>
<td style="text-align: right">151</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: right">641006</td>
<td style="text-align: left">a1050000002X1ij</td>
<td style="text-align: left">Higher Education</td>
<td style="text-align: right">160</td>
</tr>
</tbody>
</table></div></div>
<p>→ id 제외하고 다 null값인 경우 삭제 (Loan Theme ID가 null이면 Loan Theme Type, Partner ID도 다 null)</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">print</span><span class="p">(</span><span class="s">'결측치 제거 이전: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">loan_themes_df</span><span class="p">))</span>

 <span class="n">loan_themes_df</span> <span class="o">=</span> <span class="n">loan_themes_df</span><span class="p">[</span><span class="o">~</span><span class="n">loan_themes_df</span><span class="p">[</span><span class="s">'Loan Theme ID'</span><span class="p">].</span><span class="n">isna</span><span class="p">()]</span>
 <span class="n">loan_themes_df</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="k">print</span><span class="p">(</span><span class="s">'결측치 제거 이후: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">loan_themes_df</span><span class="p">))</span>
</code></pre></div></div>
</li>
<li>
<p>loan_themes_by_region.csv</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">themes_region_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/loan_themes_by_region.csv'</span><span class="p">)</span>
 <span class="n">themes_region_df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: right">Partner ID</th>
<th style="text-align: left">Field Partner Name</th>
<th style="text-align: left">sector</th>
<th style="text-align: left">Loan Theme ID</th>
<th style="text-align: left">Loan Theme Type</th>
<th style="text-align: left">country</th>
<th style="text-align: left">forkiva</th>
<th style="text-align: left">region</th>
<th style="text-align: left">geocode_old</th>
<th style="text-align: left">ISO</th>
<th style="text-align: right">number</th>
<th style="text-align: right">amount</th>
<th style="text-align: left">LocationName</th>
<th style="text-align: left">geocode</th>
<th style="text-align: left">names</th>
<th style="text-align: left">geo</th>
<th style="text-align: right">lat</th>
<th style="text-align: right">lon</th>
<th style="text-align: left">mpi_region</th>
<th style="text-align: left">mpi_geo</th>
<th style="text-align: right">rural_pct</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: right">9</td>
<td style="text-align: left">KREDIT Microfinance Institution</td>
<td style="text-align: left">General Financial Inclusion</td>
<td style="text-align: left">a1050000000slfi</td>
<td style="text-align: left">Higher Education</td>
<td style="text-align: left">Cambodia</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Banteay Meanchey</td>
<td style="text-align: left">(13.75, 103.0)</td>
<td style="text-align: left">KHM</td>
<td style="text-align: right">1</td>
<td style="text-align: right">450</td>
<td style="text-align: left">Banteay Meanchey, Cambodia</td>
<td style="text-align: left">[(13.6672596, 102.8975098)]</td>
<td style="text-align: left">Banteay Meanchey Province; Cambodia</td>
<td style="text-align: left">(13.6672596, 102.8975098)</td>
<td style="text-align: right">13.6673</td>
<td style="text-align: right">102.898</td>
<td style="text-align: left">Banteay Mean Chey, Cambodia</td>
<td style="text-align: left">(13.6672596, 102.8975098)</td>
<td style="text-align: right">90</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: right">9</td>
<td style="text-align: left">KREDIT Microfinance Institution</td>
<td style="text-align: left">General Financial Inclusion</td>
<td style="text-align: left">a10500000068jPe</td>
<td style="text-align: left">Vulnerable Populations</td>
<td style="text-align: left">Cambodia</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Battambang Province</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">KHM</td>
<td style="text-align: right">58</td>
<td style="text-align: right">20275</td>
<td style="text-align: left">Battambang Province, Cambodia</td>
<td style="text-align: left">[(13.0286971, 102.989615)]</td>
<td style="text-align: left">Battambang Province; Cambodia</td>
<td style="text-align: left">(13.0286971, 102.989615)</td>
<td style="text-align: right">13.0287</td>
<td style="text-align: right">102.99</td>
<td style="text-align: left">Banteay Mean Chey, Cambodia</td>
<td style="text-align: left">(13.6672596, 102.8975098)</td>
<td style="text-align: right">90</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: right">9</td>
<td style="text-align: left">KREDIT Microfinance Institution</td>
<td style="text-align: left">General Financial Inclusion</td>
<td style="text-align: left">a1050000000slfi</td>
<td style="text-align: left">Higher Education</td>
<td style="text-align: left">Cambodia</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Battambang Province</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">KHM</td>
<td style="text-align: right">7</td>
<td style="text-align: right">9150</td>
<td style="text-align: left">Battambang Province, Cambodia</td>
<td style="text-align: left">[(13.0286971, 102.989615)]</td>
<td style="text-align: left">Battambang Province; Cambodia</td>
<td style="text-align: left">(13.0286971, 102.989615)</td>
<td style="text-align: right">13.0287</td>
<td style="text-align: right">102.99</td>
<td style="text-align: left">Banteay Mean Chey, Cambodia</td>
<td style="text-align: left">(13.6672596, 102.8975098)</td>
<td style="text-align: right">90</td>
</tr>
</tbody>
</table></div></div>
<ul>
<li>forkiva: Was this loan theme created specifically for Kiva?</li>
<li>geocode_old: 옛날 geocoding system</li>
<li>ISO: unique ID for country</li>
<li>number: Number of loans funded in this LocationName and this loan theme</li>
<li>amount: Dollar value of loans funded in this LocationName and this loan theme</li>
<li>LocationName: “{region}, {country}”</li>
<li>names: All placenames that the Gmaps API associates with LocationName</li>
<li>mpi_region: MPI Region where we think this loan theme is located</li>
<li>mpi_geo: Lat-Lon pair where we think this MPI region is located</li>
<li>rural_pct: The percentage of this field partners’ borrowers that are in rural areas</li>
</ul>
</li>
</ol>
<h3 id="kiva만을-위한-loan-비중-확인"> <a href="#kiva%EB%A7%8C%EC%9D%84-%EC%9C%84%ED%95%9C-loan-%EB%B9%84%EC%A4%91-%ED%99%95%EC%9D%B8" aria-labelledby="kiva만을-위한-loan-비중-확인" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> kiva만을 위한 loan 비중 확인</h3>
<ol>
<li>
<p>kiva_df와 loan_themes_df를 merge</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">kiva_loan_themes</span> <span class="o">=</span> <span class="n">kiva_df</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
 <span class="n">kiva_loan_themes</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'loan_amount'</span><span class="p">,</span> <span class="s">'country_code'</span><span class="p">,</span> <span class="s">'disbursed_time'</span><span class="p">,</span> <span class="s">'tags'</span><span class="p">,</span> <span class="s">'date'</span><span class="p">,</span> <span class="s">'borrower_genders'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s">'columns'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="n">kiva_loan_themes</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kiva_loan_themes</span><span class="p">,</span> <span class="n">loan_themes_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'id'</span><span class="p">)</span>
 <span class="n">kiva_loan_themes</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: right">id</th>
<th style="text-align: right">funded_amount</th>
<th style="text-align: left">activity</th>
<th style="text-align: left">sector</th>
<th style="text-align: left">use</th>
<th style="text-align: left">country</th>
<th style="text-align: left">region</th>
<th style="text-align: left">currency</th>
<th style="text-align: right">partner_id</th>
<th style="text-align: left">posted_time</th>
<th style="text-align: left">funded_time</th>
<th style="text-align: right">term_in_months</th>
<th style="text-align: right">lender_count</th>
<th style="text-align: left">repayment_interval</th>
<th style="text-align: right">posted_month</th>
<th style="text-align: left">posted_quarter</th>
<th style="text-align: left">borrower_type</th>
<th style="text-align: left">Loan Theme ID</th>
<th style="text-align: left">Loan Theme Type</th>
<th style="text-align: right">Partner ID</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: right">653051</td>
<td style="text-align: right">300</td>
<td style="text-align: left">Fruits &amp; Vegetables</td>
<td style="text-align: left">Food</td>
<td style="text-align: left">To buy seasonal, fresh fruits to sell.</td>
<td style="text-align: left">Pakistan</td>
<td style="text-align: left">Lahore</td>
<td style="text-align: left">PKR</td>
<td style="text-align: right">247</td>
<td style="text-align: left">2014-01-01 06:12:39+00:00</td>
<td style="text-align: left">2014-01-02 10:06:32+00:00</td>
<td style="text-align: right">12</td>
<td style="text-align: right">12</td>
<td style="text-align: left">irregular</td>
<td style="text-align: right">201401</td>
<td style="text-align: left">2014Q1</td>
<td style="text-align: left">female</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">nan</td>
<td style="text-align: right">nan</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: right">653053</td>
<td style="text-align: right">575</td>
<td style="text-align: left">Rickshaw</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">to repair and maintain the auto rickshaw used in their business.</td>
<td style="text-align: left">Pakistan</td>
<td style="text-align: left">Lahore</td>
<td style="text-align: left">PKR</td>
<td style="text-align: right">247</td>
<td style="text-align: left">2014-01-01 06:51:08+00:00</td>
<td style="text-align: left">2014-01-02 09:17:23+00:00</td>
<td style="text-align: right">11</td>
<td style="text-align: right">14</td>
<td style="text-align: left">irregular</td>
<td style="text-align: right">201401</td>
<td style="text-align: left">2014Q1</td>
<td style="text-align: left">female_group</td>
<td style="text-align: left">a1050000000sjEC</td>
<td style="text-align: left">Underserved</td>
<td style="text-align: right">247</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: right">653068</td>
<td style="text-align: right">150</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">To repair their old cycle-van and buy another one to rent out as a source of income</td>
<td style="text-align: left">India</td>
<td style="text-align: left">Maynaguri</td>
<td style="text-align: left">INR</td>
<td style="text-align: right">334</td>
<td style="text-align: left">2014-01-01 09:58:07+00:00</td>
<td style="text-align: left">2014-01-01 16:01:36+00:00</td>
<td style="text-align: right">43</td>
<td style="text-align: right">6</td>
<td style="text-align: left">bullet</td>
<td style="text-align: right">201401</td>
<td style="text-align: left">2014Q1</td>
<td style="text-align: left">female</td>
<td style="text-align: left">a1050000002VkWz</td>
<td style="text-align: left">Underserved</td>
<td style="text-align: right">334</td>
</tr>
</tbody>
</table></div></div>
<p>→ 결합 후의 null값 파악</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">kiva_loan_themes</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;class 'pandas.core.frame.DataFrame'&gt;
 Int64Index: 671205 entries, 0 to 671204
 Data columns (total 17 columns):
 #   Column              Non-Null Count   Dtype              
 ---  ------              --------------   -----              
 0   id                  671205 non-null  int64              
 1   funded_amount       671205 non-null  float64            
 2   activity            671205 non-null  object             
 3   sector              671205 non-null  object             
 4   country             671205 non-null  object             
 5   region              614405 non-null  object             
 6   currency            671205 non-null  object             
 7   partner_id          657698 non-null  float64            
 8   posted_time         671205 non-null  datetime64[ns, UTC]
 9   funded_time         622874 non-null  datetime64[ns, UTC]
 10  term_in_months      671205 non-null  float64            
 11  lender_count        671205 non-null  int64              
 12  borrower_genders    666984 non-null  object             
 13  repayment_interval  671205 non-null  object             
 14  Loan Theme ID       657692 non-null  object             
 15  Loan Theme Type     657692 non-null  object             
 16  Partner ID          657692 non-null  float64            
 dtypes: datetime64[ns, UTC](2), float64(4), int64(2), object(9)
 memory usage: 92.2+ MB
</code></pre></div></div>
</li>
<li>
<p>위에서 만든 kiva_loan_themes에 themes_region_df를 merge</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">temp1</span> <span class="o">=</span> <span class="n">kiva_loan_themes</span><span class="p">[[</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="s">'posted_quarter'</span><span class="p">,</span> <span class="s">'Loan Theme ID'</span><span class="p">,</span> <span class="s">'borrower_type'</span><span class="p">,</span> <span class="s">'activity'</span><span class="p">,</span> <span class="s">'sector'</span><span class="p">,</span> <span class="s">'use'</span><span class="p">,</span> <span class="s">'country'</span><span class="p">]]</span>

 <span class="n">temp2</span> <span class="o">=</span> <span class="n">themes_region_df</span><span class="p">[[</span><span class="s">'Loan Theme ID'</span><span class="p">,</span> <span class="s">'Loan Theme Type'</span><span class="p">,</span> <span class="s">'forkiva'</span><span class="p">,</span> <span class="s">'Partner ID'</span><span class="p">,</span> <span class="s">'Field Partner Name'</span><span class="p">]]</span>
 <span class="n">temp2</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="n">kiva_themes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">temp1</span><span class="p">,</span> <span class="n">temp2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'Loan Theme ID'</span><span class="p">)</span>
 <span class="n">kiva_themes_df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: right">funded_amount</th>
<th style="text-align: left">posted_quarter</th>
<th style="text-align: left">Loan Theme ID</th>
<th style="text-align: left">borrower_type</th>
<th style="text-align: left">activity</th>
<th style="text-align: left">sector</th>
<th style="text-align: left">use</th>
<th style="text-align: left">country</th>
<th style="text-align: left">Loan Theme Type</th>
<th style="text-align: left">forkiva</th>
<th style="text-align: right">Partner ID</th>
<th style="text-align: left">Field Partner Name</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: right">300</td>
<td style="text-align: left">2014Q1</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">female</td>
<td style="text-align: left">Fruits &amp; Vegetables</td>
<td style="text-align: left">Food</td>
<td style="text-align: left">To buy seasonal, fresh fruits to sell.</td>
<td style="text-align: left">Pakistan</td>
<td style="text-align: left">nan</td>
<td style="text-align: left">nan</td>
<td style="text-align: right">nan</td>
<td style="text-align: left">nan</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: right">575</td>
<td style="text-align: left">2014Q1</td>
<td style="text-align: left">a1050000000sjEC</td>
<td style="text-align: left">female_group</td>
<td style="text-align: left">Rickshaw</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">to repair and maintain the auto rickshaw used in their business.</td>
<td style="text-align: left">Pakistan</td>
<td style="text-align: left">Underserved</td>
<td style="text-align: left">No</td>
<td style="text-align: right">247</td>
<td style="text-align: left">BRAC Pakistan</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: right">150</td>
<td style="text-align: left">2014Q1</td>
<td style="text-align: left">a1050000002VkWz</td>
<td style="text-align: left">female</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">Transportation</td>
<td style="text-align: left">To repair their old cycle-van and buy another one to rent out as a source of income</td>
<td style="text-align: left">India</td>
<td style="text-align: left">Underserved</td>
<td style="text-align: left">Yes</td>
<td style="text-align: right">334</td>
<td style="text-align: left">Belghoria Janakalyan Samity</td>
</tr>
</tbody>
</table></div></div>
<p>→ 결합 후의 null값 파악</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">kiva_themes_df</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;class 'pandas.core.frame.DataFrame'&gt;
 Int64Index: 671205 entries, 0 to 671204
 Data columns (total 11 columns):
 #   Column              Non-Null Count   Dtype  
 ---  ------              --------------   -----  
 0   funded_amount       671205 non-null  float64
 1   posted_quarter      671205 non-null  object 
 2   Loan Theme ID       657692 non-null  object 
 3   borrower_type       671205 non-null  object 
 4   activity            671205 non-null  object 
 5   sector              671205 non-null  object 
 6   country             671205 non-null  object 
 7   Loan Theme Type     629021 non-null  object 
 8   forkiva             629021 non-null  object 
 9   Partner ID          629021 non-null  float64
 10  Field Partner Name  629021 non-null  object 
 dtypes: float64(2), object(9)
 memory usage: 61.5+ MB
</code></pre></div></div>
</li>
<li>kiva loan 중 kiva만을 위한 loan이 어느 정도인지 파악<ul><li>forkiva=Yes면 kiva만을 위해 구축한 loan이라는 의미</li></ul>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">kiva_themes_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'forkiva'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_24.png" alt="forkiva_count"></p>
</li>
<li>
<p>kiva만을 위한 loan과 아닌 loan의 평균 funded amount 비교</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">kiva_themes_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'forkiva'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_25.png" alt="forkiva_avg_amount"></p>
<ul><li>forkiva=No인 loan이 압도적으로 많지만, 평균 funded amount 자체는 별 차이가 없음</li></ul>
</li>
<li>
<p>kiva만을 위한 loan과 아닌 loan의 분기별 총 funded amount 추이</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">temp</span> <span class="o">=</span> <span class="n">kiva_themes_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'posted_quarter'</span><span class="p">,</span> <span class="s">'forkiva'</span><span class="p">])[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>

 <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">temp</span><span class="p">[</span><span class="s">'posted_quarter'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'2017Q3'</span><span class="p">],</span> 
             <span class="n">x</span><span class="o">=</span><span class="s">'posted_quarter'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'forkiva'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_26.png" alt="quarterly_forkiva_amount"></p>
<ul><li>kiva만을 위한 loan과 그렇지 않은 loan 모두 funded amount가 증가 추세에 있다</li></ul>
</li>
</ol>
<h3 id="country-sector별-forkiva-비중"> <a href="#country-sector%EB%B3%84-forkiva-%EB%B9%84%EC%A4%91" aria-labelledby="country-sector별-forkiva-비중" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> country, sector별 forkiva 비중</h3>
<ol>
<li>
<p>kiva만을 위한 loan 비중이 많은 country 확인</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># country별 forkiva=yes인 비중: 총 funded amount를 기준으로 계산
</span> <span class="n">country_forkiva</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s">'country'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'forkiva'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'sum'</span><span class="p">)</span>
 <span class="n">country_forkiva</span><span class="p">[</span><span class="s">'forkiva_ratio(%)'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">country_forkiva</span><span class="p">[</span><span class="s">'Yes'</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">country_forkiva</span><span class="p">[</span><span class="s">'No'</span><span class="p">]</span> <span class="o">+</span> <span class="n">country_forkiva</span><span class="p">[</span><span class="s">'Yes'</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
 <span class="n">country_forkiva</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'forkiva_ratio(%)'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
 <span class="n">country_forkiva</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: left">country</th>
<th style="text-align: right">No</th>
<th style="text-align: right">Yes</th>
<th style="text-align: right">forkiva_ratio(%)</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left">Belize</td>
<td style="text-align: right">0</td>
<td style="text-align: right">63150</td>
<td style="text-align: right">100.00</td>
</tr>
<tr>
<td style="text-align: left">Chile</td>
<td style="text-align: right">0</td>
<td style="text-align: right">38525</td>
<td style="text-align: right">100.00</td>
</tr>
<tr>
<td style="text-align: left">Georgia</td>
<td style="text-align: right">105875</td>
<td style="text-align: right">3263625</td>
<td style="text-align: right">96.86</td>
</tr>
<tr>
<td style="text-align: left">Lao People’s Democratic Republic</td>
<td style="text-align: right">59000</td>
<td style="text-align: right">1089050</td>
<td style="text-align: right">94.86</td>
</tr>
<tr>
<td style="text-align: left">Moldova</td>
<td style="text-align: right">58825</td>
<td style="text-align: right">628025</td>
<td style="text-align: right">91.44</td>
</tr>
<tr>
<td style="text-align: left">Myanmar (Burma)</td>
<td style="text-align: right">292925</td>
<td style="text-align: right">2742925</td>
<td style="text-align: right">90.35</td>
</tr>
<tr>
<td style="text-align: left">Egypt</td>
<td style="text-align: right">428750</td>
<td style="text-align: right">656175</td>
<td style="text-align: right">60.48</td>
</tr>
<tr>
<td style="text-align: left">Mongolia</td>
<td style="text-align: right">532425</td>
<td style="text-align: right">676950</td>
<td style="text-align: right">55.98</td>
</tr>
<tr>
<td style="text-align: left">Zimbabwe</td>
<td style="text-align: right">1690075</td>
<td style="text-align: right">1365500</td>
<td style="text-align: right">44.69</td>
</tr>
<tr>
<td style="text-align: left">India</td>
<td style="text-align: right">2932575</td>
<td style="text-align: right">2312850</td>
<td style="text-align: right">44.09</td>
</tr>
</tbody>
</table></div></div>
<p>→ forkiva=yes인 비중이 0보다 큰 국가만 시각화</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">country_forkiva</span><span class="p">[</span><span class="n">country_forkiva</span><span class="p">[</span><span class="s">'forkiva_ratio(%)'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">].</span><span class="n">reset_index</span><span class="p">(),</span> 
             <span class="n">x</span><span class="o">=</span><span class="s">'forkiva_ratio(%)'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'country'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_27.png" alt="forkiva_amount_per_country"></p>
<ul>
<li>Belize, Chile는 지원받은 금액의 100%가 kiva만을 위해 구축된 loan</li>
<li>Georgia, Lao People’s Democratic Republic, Moldova, Myanmar는 90% 이상의 금액이 kiva만을 위한 loan으로 지원받은 것</li>
</ul>
</li>
<li>
<p>kiva만을 위한 loan 비중이 많은 sector 확인</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">sector_forkiva</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">kiva_themes_df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s">'sector'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'forkiva'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'sum'</span><span class="p">)</span>
 <span class="n">sector_forkiva</span><span class="p">[</span><span class="s">'forkiva_ratio(%)'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sector_forkiva</span><span class="p">[</span><span class="s">'Yes'</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">sector_forkiva</span><span class="p">[</span><span class="s">'No'</span><span class="p">]</span> <span class="o">+</span> <span class="n">sector_forkiva</span><span class="p">[</span><span class="s">'Yes'</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
 <span class="n">sector_forkiva</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'forkiva_ratio(%)'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="c1"># Sector별 forkiva 비중을 시각화
</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sector_forkiva</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">x</span><span class="o">=</span><span class="s">'forkiva_ratio(%)'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'sector'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_28.png" alt="forkiva_amount_per_sector"></p>
<ul><li>‘Personal Use’ sector는 funded amount의 약 43%가 kiva만을 위한 단독 loan으로 지원받은 것</li></ul>
</li>
<li>
<p>kiva만을 위한 loan 중, ‘Personal Use’ sector의 구체적인 use를 파악</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">temp</span> <span class="o">=</span> <span class="n">kiva_themes_df</span><span class="p">[(</span><span class="n">kiva_themes_df</span><span class="p">[</span><span class="s">'forkiva'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Yes'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">kiva_themes_df</span><span class="p">[</span><span class="s">'sector'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Personal Use'</span><span class="p">)]</span>
 <span class="n">temp</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'use'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: left">use</th>
<th style="text-align: right">funded_amount</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left">to buy a water filter to provide safe drinking water for their family.</td>
<td style="text-align: right">805125</td>
</tr>
<tr>
<td style="text-align: left">to buy a water filter to provide safe drinking water for her family.</td>
<td style="text-align: right">628150</td>
</tr>
<tr>
<td style="text-align: left">to purchase TerraClear water filters so they can have access to safe drinking water.</td>
<td style="text-align: right">566900</td>
</tr>
<tr>
<td style="text-align: left">To buy a water filter to provide safe drinking water for their family.</td>
<td style="text-align: right">253300</td>
</tr>
<tr>
<td style="text-align: left">to buy a water filter to provide safe drinking water for his family.</td>
<td style="text-align: right">200375</td>
</tr>
</tbody>
</table></div></div>
<p>→ use에 등장하는 단어를 wordcloud로 시각화</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># Text Cleaning &amp; Case Conversion &amp; Tokenization
</span> <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
 <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">kiva_themes_df</span><span class="p">[(</span><span class="n">kiva_themes_df</span><span class="p">[</span><span class="s">'forkiva'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Yes'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">kiva_themes_df</span><span class="p">[</span><span class="s">'sector'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Personal Use'</span><span class="p">)][</span><span class="s">'use'</span><span class="p">]:</span>
     <span class="n">content_cleaned</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">content</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'.'</span><span class="p">,</span> <span class="s">''</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">','</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">().</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># ., 정도만 제거, strip, lower 
</span>     <span class="n">words</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">content_cleaned</span><span class="p">.</span><span class="n">split</span><span class="p">())</span>  <span class="c1"># 간단하게 공백 기준으로만 쪼개줌
</span>
 <span class="c1"># POS Tagging
</span> <span class="n">tokens_pos</span> <span class="o">=</span> <span class="n">nltk</span><span class="p">.</span><span class="n">pos_tag</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>  

 <span class="c1"># Noun, Verb만 추출 &amp; Lemmatization
</span> <span class="n">wlem</span> <span class="o">=</span> <span class="n">nltk</span><span class="p">.</span><span class="n">WordNetLemmatizer</span><span class="p">()</span>
 <span class="n">lemm_words</span> <span class="o">=</span> <span class="p">[]</span>

 <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">tokens_pos</span><span class="p">:</span>
     <span class="k">if</span> <span class="p">(</span><span class="s">'NN'</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s">'VB'</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">):</span>
         <span class="n">lemm_words</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">wlem</span><span class="p">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>

 <span class="c1"># Counter로 빈도 계산
</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">lemm_words</span><span class="p">)</span>

 <span class="n">generate_wordcloud</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  <span class="c1"># 위에서 만들어둔 워드클라우드 만드는 함수
</span></code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_29.png" alt="forkiva_personal_use_wordcloud"></p>
<p>+) Top 10 단어 bar graph로 시각화</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">visualize_top10_words</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  <span class="c1"># 위에서 만들어둔 top 10 단어 bargraph 만드는 함수
</span></code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_30.png" alt="forkiva_personal_use_bargraph"></p>
<ul>
<li>drinking water 관련 loan이 많다고 판단됨</li>
<li>식수도 관련 타 loan / 사업을 끌어오면 kiva 100% loan을 구축하지 않고도 다른 방법으로 금전적 지원이 가능할 수 있다고 생각됨</li>
</ul>
</li>
</ol>
<h3 id="field-partner와의-협업-관계-확인"> <a href="#field-partner%EC%99%80%EC%9D%98-%ED%98%91%EC%97%85-%EA%B4%80%EA%B3%84-%ED%99%95%EC%9D%B8" aria-labelledby="field-partner와의-협업-관계-확인" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Field Partner와의 협업 관계 확인</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># funded amount순으로 Field Partner Name 확인
</span><span class="n">loans_partner</span> <span class="o">=</span> <span class="n">kiva_themes_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Field Partner Name'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">loans_partner</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">loans_partner</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Field Partner Name'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'pink'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_31.png" alt="fied_partner_funded_amount"></p>
<ul><li>Negros Women for Tomorrow Foundation (NWTF)가 가장 많은 funded amount의 자금 융통을 담당하는 field partner</li></ul>
<p>+) NWTF가 주로 담당하는 지역 확인:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">kiva_themes_df</span><span class="p">[</span><span class="n">kiva_themes_df</span><span class="p">[</span><span class="s">'Field Partner Name'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Negros Women for Tomorrow Foundation (NWTF)'</span><span class="p">]</span>
<span class="n">temp</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'country'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: left">country</th>
<th style="text-align: right">funded_amount</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left">Philippines</td>
<td style="text-align: right">33831500.0</td>
</tr>
<tr>
<td style="text-align: left">Kenya</td>
<td style="text-align: right">25.0</td>
</tr>
<tr>
<td style="text-align: left">Bolivia</td>
<td style="text-align: right">0.0</td>
</tr>
</tbody>
</table></div></div>
<ul><li>NWTF는 Philippines에서 주로 활동하는 field partner인 것으로 확인됨</li></ul>
<h3 id="국가별-funded-amount와-mpi"> <a href="#%EA%B5%AD%EA%B0%80%EB%B3%84-funded-amount%EC%99%80-mpi" aria-labelledby="국가별-funded-amount와-mpi" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 국가별 funded amount와 MPI</h3>
<ul><li>국가별 총 funded amount와 평균 MPI 지수를 비교</li></ul>
<ol>
<li>
<p>region 기준으로 merge가 가능할지 탐색</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">kiva_df_region_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kiva_df</span><span class="p">[</span><span class="s">'region'</span><span class="p">])</span>
 <span class="n">location_df_region_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">location_df</span><span class="p">[</span><span class="s">'region'</span><span class="p">])</span>

 <span class="k">print</span><span class="p">(</span><span class="s">'kiva_df: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">kiva_df_region_set</span><span class="p">))</span>
 <span class="k">print</span><span class="p">(</span><span class="s">'location_df: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">location_df_region_set</span><span class="p">))</span>
 <span class="k">print</span><span class="p">(</span><span class="s">'겹치는 region: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">kiva_df_region_set</span> <span class="o">&amp;</span> <span class="n">location_df_region_set</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> kiva_df:  12696
 location_df:  838
 겹치는 region:  129
</code></pre></div></div>
<ul><li>겹치는 region이 너무 적어서 단순 merge는 불가…</li></ul>
</li>
<li>
<p>country 기준으로 총 funded amount, 평균 MPI 지수를 각각 groupby 후 merge</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">kiva_df_groupby</span> <span class="o">=</span> <span class="n">kiva_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'country'</span><span class="p">)[[</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="s">'loan_amount'</span><span class="p">]].</span><span class="nb">sum</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>
 <span class="n">location_df_groupby</span> <span class="o">=</span> <span class="n">location_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'country'</span><span class="p">,</span> <span class="s">'world_region'</span><span class="p">])[[</span><span class="s">'MPI'</span><span class="p">]].</span><span class="n">mean</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>

 <span class="n">groupby_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kiva_df_groupby</span><span class="p">,</span> <span class="n">location_df_groupby</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'inner'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'country'</span><span class="p">)</span>
 <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groupby_merged</span><span class="p">))</span>
 <span class="n">groupby_merged</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<div class="code-example"><div class="table-wrapper"><table>
<thead><tr>
<th style="text-align: right"> </th>
<th style="text-align: left">country</th>
<th style="text-align: right">funded_amount</th>
<th style="text-align: right">loan_amount</th>
<th style="text-align: left">world_region</th>
<th style="text-align: right">MPI</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align: right">0</td>
<td style="text-align: left">Afghanistan</td>
<td style="text-align: right">14000</td>
<td style="text-align: right">14000</td>
<td style="text-align: left">South Asia</td>
<td style="text-align: right">0.309853</td>
</tr>
<tr>
<td style="text-align: right">1</td>
<td style="text-align: left">Belize</td>
<td style="text-align: right">114025</td>
<td style="text-align: right">114025</td>
<td style="text-align: left">Latin America and Caribbean</td>
<td style="text-align: right">0.0201429</td>
</tr>
<tr>
<td style="text-align: right">2</td>
<td style="text-align: left">Benin</td>
<td style="text-align: right">516825</td>
<td style="text-align: right">518950</td>
<td style="text-align: left">Sub-Saharan Africa</td>
<td style="text-align: right">0.320333</td>
</tr>
<tr>
<td style="text-align: right">3</td>
<td style="text-align: left">Bhutan</td>
<td style="text-align: right">15625</td>
<td style="text-align: right">20000</td>
<td style="text-align: left">South Asia</td>
<td style="text-align: right">0.123474</td>
</tr>
<tr>
<td style="text-align: right">4</td>
<td style="text-align: left">Brazil</td>
<td style="text-align: right">661025</td>
<td style="text-align: right">662200</td>
<td style="text-align: left">Latin America and Caribbean</td>
<td style="text-align: right">0.0272593</td>
</tr>
</tbody>
</table></div></div>
<p>→ 국가별 총 funded_amount와 평균 MPI 간의 관계 시각화</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
 <span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">groupby_merged</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'funded_amount'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'MPI'</span><span class="p">,</span> 
                 <span class="n">hue</span><span class="o">=</span><span class="s">'world_region'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'world_region'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'Set2'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span>
</code></pre></div></div>
<p><img src="../../../assets/images/kaggle/kiva_crowdfunding_2_32.png" alt="country_amount_mpi_scatter"></p>
<ul>
<li>평균 MPI가 높은 국가일수록 funded amount가 많을 거라고 예상했지만, 그런 관계는 발견되지 않음</li>
<li>오히려 평균 MPI가 높은 (= poverty level이 높은) Sub-Shararan Africa의 국가들 중 상위 8개 국가는 funded amount가 많지 않은 편</li>
</ul>
</li>
</ol>
<hr>
<footer><p class="text-small text-grey-dk-000 mb-0">Copyright © 2021 Chaeyun.<br>This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a Jekyll theme.</p></footer>
</div>
</div>
<div class="search-overlay"></div>
</div>
</body>
</html>
