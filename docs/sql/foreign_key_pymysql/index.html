<!DOCTYPE html>
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<link rel="shortcut icon" href="https://chaelist.github.io/assets/images/cat.png" type="image/x-icon">
<link rel="stylesheet" href="https://chaelist.github.io/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-QJ6H6890X3"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QJ6H6890X3'); </script> <script type="text/javascript" src="https://chaelist.github.io/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://chaelist.github.io/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Foreign Key &amp; Python 연결 | chaelist</title>
<meta name="generator" content="Jekyll v4.2.1">
<meta property="og:title" content="Foreign Key &amp; Python 연결">
<meta property="og:locale" content="en_US">
<meta name="description" content="chaelist’s blog">
<meta property="og:description" content="chaelist’s blog">
<link rel="canonical" href="https://chaelist.github.io/docs/sql/foreign_key_pymysql/">
<meta property="og:url" content="https://chaelist.github.io/docs/sql/foreign_key_pymysql/">
<meta property="og:site_name" content="chaelist">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Foreign Key &amp; Python 연결"> <script type="application/ld+json"> {"description":"chaelist’s blog","url":"https://chaelist.github.io/docs/sql/foreign_key_pymysql/","@type":"WebPage","headline":"Foreign Key &amp; Python 연결","@context":"https://schema.org"}</script>
</head>
<body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewbox="0 0 24 24"><title>Link</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"><title>Search</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"><title>Menu</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"><title>Expand</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"><title>Document</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar">
<div class="site-header"> <a href="https://chaelist.github.io/" class="site-title lh-tight"> chaelist </a> <a href="#" id="menu-button" class="site-button"> <svg viewbox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a>
</div>
<nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list">
<li class="nav-list-item"><a href="https://chaelist.github.io/" class="nav-list-link">Home</a></li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/python_basics" class="nav-list-link">Python 기초</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/python_basics/numbers_list_string/" class="nav-list-link">Numbers, List, String</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/python_basics/dictionary_tuple_set/" class="nav-list-link">Dictionary, Tuple, Set</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/python_basics/controlflow/" class="nav-list-link">Control Flow (제어문)</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/python_basics/function_module/" class="nav-list-link">Function &amp; Module</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/data_handling" class="nav-list-link">Data Handling</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/file_input_output/" class="nav-list-link">파일 읽고 쓰기</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/file_folder_handling/" class="nav-list-link">파일 &amp; 폴더 다루기</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/regular_expressions/" class="nav-list-link">Regular Expressions</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/useful_functions/" class="nav-list-link">유용한 Python 내장함수</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/data_handling/datetime/" class="nav-list-link">Datetime 다루기</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/numpy" class="nav-list-link">Numpy</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/numpy/numpy_basics/" class="nav-list-link">Numpy 기초</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/numpy/numpy_arithmetics/" class="nav-list-link">Numpy 연산과 통계</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/pandas" class="nav-list-link">Pandas</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_basics/" class="nav-list-link">Pandas 기초</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_data_modifying/" class="nav-list-link">Pandas 데이터 가공</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_data_analysis/" class="nav-list-link">Pandas 데이터 분석</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_merge_group/" class="nav-list-link">Pandas 데이터 결합 &amp; 요약</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/pandas/pandas_str_dt_con/" class="nav-list-link">Pandas str, dt, 조건문</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/visualization" class="nav-list-link">데이터 시각화</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/visualization/pandas_plot/" class="nav-list-link">Pandas plot() 함수</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/visualization/seaborn/" class="nav-list-link">Seaborn</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/visualization/matplotlib/" class="nav-list-link">Matplotlib</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/visualization/plotly/" class="nav-list-link">Plotly</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/webscraping" class="nav-list-link">Web Scraping</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/requests_beautifulsoup/" class="nav-list-link">Requests &amp; BeautifulSoup</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/selenium/" class="nav-list-link">Selenium</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/image_api/" class="nav-list-link">Image 수집 &amp; API 활용</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/twitter_api/" class="nav-list-link">Twitter 데이터 수집</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/webscraping/app_review/" class="nav-list-link">App Review 수집</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/text_analysis" class="nav-list-link">Text 분석</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/text_analysis/english_text/" class="nav-list-link">빈도 분석 (English)</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/text_analysis/korean_text/" class="nav-list-link">빈도 분석 (한글)</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/network_analysis" class="nav-list-link">Network Analysis</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/network_analysis/network_basics/" class="nav-list-link">Network Analysis 기초</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/network_analysis/social_network/" class="nav-list-link">Social Network Analysis</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/network_analysis/semantic_network/" class="nav-list-link">Semantic Network Analysis</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/ml_basics" class="nav-list-link">Machine Learning 기초</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/linear_regression/" class="nav-list-link">기초 &amp; Linear Regression</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/classification1/" class="nav-list-link">Classification 1</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/classification2/" class="nav-list-link">Classification 2</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/clustering/" class="nav-list-link">Clustering</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_basics/deep_learning/" class="nav-list-link">Deep Learning 기초</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/ml_advanced" class="nav-list-link">Machine Learning 심화</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_advanced/regularization/" class="nav-list-link">Regularization</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_advanced/preprocessing/" class="nav-list-link">데이터 전처리</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_advanced/model_selection/" class="nav-list-link">Model Selection</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/ml_application" class="nav-list-link">Machine Learning 응용</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/sentiment_analysis/" class="nav-list-link">영화 리뷰 감성 분석</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/news_clustering/" class="nav-list-link">뉴스 기사 Clustering</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/time_series/" class="nav-list-link">시계열 데이터 예측</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/topic_modeling/" class="nav-list-link">Topic Modeling (LDA)</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/logistics/" class="nav-list-link">물류 최적화</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/ml_application/image_processing/" class="nav-list-link">이미지 / 동영상 처리</a></li>
</ul>
</li>
<li class="nav-list-item active">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/sql" class="nav-list-link">SQL</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/select_basics/" class="nav-list-link">데이터 조회 기초</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/select_advanced/" class="nav-list-link">데이터 조회 심화</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/join_subq_view/" class="nav-list-link">조인, 서브쿼리, 뷰</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/db_table_create/" class="nav-list-link">데이터베이스 &amp; 테이블 구축</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/sql/modify_table/" class="nav-list-link">테이블 가공</a></li>
<li class="nav-list-item active"><a href="https://chaelist.github.io/docs/sql/foreign_key_pymysql/" class="nav-list-link active">Foreign Key &amp; Python 연결</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://chaelist.github.io/docs/kaggle" class="nav-list-link">Kaggle Dataset EDA</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/youtube_trending/" class="nav-list-link">YouTube Trending Videos</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/amazon_bestsellers/" class="nav-list-link">Amazon Bestselling Books</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/customer_churn/" class="nav-list-link">Telco Customer Churn</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/kiva_crowdfunding/" class="nav-list-link">Kiva Crowdfunding 1</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/kiva_crowdfunding2/" class="nav-list-link">Kiva Crowdfunding 2</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/stem_salaries/" class="nav-list-link">STEM Salaries 1</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/stem_salaries2/" class="nav-list-link">STEM Salaries 2</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/uk_ecommerce/" class="nav-list-link">UK Ecommerce Data 1</a></li>
<li class="nav-list-item "><a href="https://chaelist.github.io/docs/kaggle/uk_ecommerce2/" class="nav-list-link">UK Ecommerce Data 2</a></li>
</ul>
</li>
</ul></nav><footer class="site-footer"></footer>
</div>
<div class="main" id="top">
<div id="main-header" class="main-header"><div class="search">
<div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search chaelist" aria-label="Search chaelist" autocomplete="off"> <label for="search-input" class="search-label"><svg viewbox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
</div>
<div id="search-results" class="search-results"></div>
</div></div>
<div id="main-content-wrap" class="main-content-wrap">
<nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list">
<li class="breadcrumb-nav-list-item"><a href="https://chaelist.github.io/docs/sql">SQL</a></li>
<li class="breadcrumb-nav-list-item"><span>Foreign Key &amp; Python 연결</span></li>
</ol></nav><div id="main-content" class="main-content" role="main">
<h1 class="no_toc" id="foreign-key--python-연결"> <a href="#foreign-key--python-%EC%97%B0%EA%B2%B0" aria-labelledby="foreign-key--python-연결" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Foreign Key &amp; Python 연결</h1>
<p><br></p>
<details open=""> <summary class="text-delta"> Table of contents </summary><ol id="markdown-toc">
<li>
<a href="#foreign-key" id="markdown-toc-foreign-key">Foreign Key</a><ol>
<li><a href="#%EC%B0%B8%EC%A1%B0-%EB%AC%B4%EA%B2%B0%EC%84%B1referential-integrity" id="markdown-toc-참조-무결성referential-integrity">참조 무결성(Referential Integrity)</a></li>
<li><a href="#foreign-key-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0" id="markdown-toc-foreign-key-설정하기">Foreign Key 설정하기</a></li>
<li><a href="#foreign-key-%EC%82%AD%EC%A0%9C%ED%95%98%EA%B8%B0" id="markdown-toc-foreign-key-삭제하기">Foreign Key 삭제하기</a></li>
</ol>
</li>
<li>
<a href="#foreign-key-%EC%A0%95%EC%B1%85" id="markdown-toc-foreign-key-정책">Foreign Key 정책</a><ol>
<li><a href="#on-delete" id="markdown-toc-on-delete">ON DELETE</a></li>
<li><a href="#on-update" id="markdown-toc-on-update">ON UPDATE</a></li>
</ol>
</li>
<li>
<a href="#python%EC%97%90%EC%84%9C-db-%EC%97%B0%EA%B2%B0" id="markdown-toc-python에서-db-연결">Python에서 DB 연결</a><ol><li><a href="#pymysql" id="markdown-toc-pymysql">PyMySQL</a></li></ol>
</li>
</ol></details><hr>
<h2 id="foreign-key"> <a href="#foreign-key" aria-labelledby="foreign-key" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Foreign Key</h2>
<p>: 두 개의 테이블을 연결해주는 다리 역할을 하는 key.</p>
<ul>
<li>Foreign Key가 있는 테이블: child table(자식 테이블) 혹은 referencing table이라고 지칭</li>
<li>Foreign Key에 의해 참조당하는 테이블: parent table(부모 테이블) 혹은 referenced table이라고 지칭</li>
</ul>
<p class="fs-2 text-grey-dk-000"><img src="../../../assets/images/sql/foreign_key_example.png" alt="ForeignKey_Example" width="500"> <br> <img src="../../../assets/images/sql/foreign_key_example2.png" alt="ForeignKey_Example2" width="500"> <br> (출처: SQLShack)</p>
<h3 id="참조-무결성referential-integrity"> <a href="#%EC%B0%B8%EC%A1%B0-%EB%AC%B4%EA%B2%B0%EC%84%B1referential-integrity" aria-labelledby="참조-무결성referential-integrity" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 참조 무결성(Referential Integrity)</h3>
<p>: 두 테이블 간에 참조 관계가 있을 때 각 데이터 간에 유지되어야 하는 정확성과 일관성을 의미</p>
<ul>
<li>DBMS 상에서 두 테이블 간의 Foreign Key 관계를 설정해두면 참조 무결성을 지킬 수 있다</li>
<li>ex) item_id = 10인 리뷰들이 있는데 정작 item 테이블에는 id = 10인 상품이 없다면 참조 무결성이 깨진 것!</li>
</ul>
<p class="fs-1 lh-0"> </p>
<p><strong>*논리적 Foreign Key와 물리적 Foreign Key</strong></p>
<ul>
<li>실무에서는 논리적으로 두 테이블 간에 Foreign Key 관계가 있어도 DBMS 상에서 설정해두지 않는 경우도 있다 (ex. 성능 / Legacy data 때문…)</li>
<li>논리적(Logical) Foreign Key: 논리적으로 성립하는 Foreign Key</li>
<li>물리적(Physical) Foreign Key: DBMS 상에서 실제로 Foreign Key로 설정해서 참조 무결성을 보장할 수 있게 된 것</li>
</ul>
<h3 id="foreign-key-설정하기"> <a href="#foreign-key-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0" aria-labelledby="foreign-key-설정하기" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Foreign Key 설정하기</h3>
<ol>
<li>SQL문으로 설정:<ul>
<li>형식: (Foreign Key도 일종의 Constraint이므로, ADD CONSTRAINT문을 사용)<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">ALTER</span> <span class="k">TABLE</span> <span class="err">테이블명</span> 
  <span class="k">ADD</span> <span class="k">CONSTRAINT</span> <span class="err">제약이름</span> 
      <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">foreign_key</span><span class="err">로</span><span class="n">_</span><span class="err">설정할</span><span class="n">_</span><span class="err">컬럼</span><span class="p">)</span>
      <span class="k">REFERENCES</span> <span class="err">참조하는</span><span class="n">_</span><span class="err">테이블명</span> <span class="p">(</span><span class="err">참조할</span><span class="n">_</span><span class="err">컬럼</span><span class="p">)</span>
      <span class="k">ON</span> <span class="k">DELETE</span> <span class="err">정책</span>
      <span class="k">ON</span> <span class="k">UPDATE</span> <span class="err">정책</span><span class="p">;</span>
</code></pre></div></div>
</li>
<li>예시: review 테이블의 course_id 컬럼이 foreign key, 참조되는 컬럼은 course 테이블의 id 컬럼.<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">ALTER</span> <span class="k">TABLE</span> <span class="nv">`course_rating`</span><span class="p">.</span><span class="nv">`review`</span> 
  <span class="k">ADD</span> <span class="k">CONSTRAINT</span> <span class="nv">`fk_review_table`</span>
      <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`course_id`</span><span class="p">)</span>
      <span class="k">REFERENCES</span> <span class="nv">`course_rating`</span><span class="p">.</span><span class="nv">`course`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">)</span>
      <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">RESTRICT</span>
      <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">RESTRICT</span><span class="p">;</span>
</code></pre></div></div>
</li>
<li>위와 같이 Foreign Key를 설정해두면 참조 무결성이 보장되도록 제약이 걸린다. <br> ex) course 테이블에 id = 10인 row가 없는 상황에서, review 테이블에 course_id = 10인 row를 삽입하려고 하면 error 발생.</li>
</ul>
<p class="fs-1 lh-0"> </p>
</li>
<li>workbench를 통해 직접 클릭해서 설정하는 것도 가능: <img src="../../../assets/images/sql/foreign_key_workbench.png" alt="ForeignKey_WorkBench" width="700">
</li>
</ol>
<p class="fs-1 lh-0"> </p>
<p><strong>+) 테이블에 더해진 Constraint 확인하기</strong></p>
<ul>
<li>
<code class="language-plaintext highlighter-rouge">SHOW CREATE TABLE 테이블명;</code>: 특정 테이블이 어떻게 생성되었는지를 알려주는 SQL문<br> (특정 테이블을 다시 생성한다고 하면 어떤 CREATE TABLE문을 작성해야 하는지 알려준다)</li>
<li>이를 활용하면 테이블에 더해져 있는 Constraint (Foreign Key 포함) 종류를 파악할 수 있다</li>
</ul>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SHOW</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">review</span><span class="p">;</span>
</code></pre></div></div>
<p>→ 아래와 같이 결과가 나오고, 그 내용을 복사해서 다른 곳에 붙여넣으면 전체 SQL문을 확인할 수 있다:</p>
<p><img src="../../../assets/images/sql/show_create_table.png" alt="Show_Create_Table" width="650"></p>
<h3 id="foreign-key-삭제하기"> <a href="#foreign-key-%EC%82%AD%EC%A0%9C%ED%95%98%EA%B8%B0" aria-labelledby="foreign-key-삭제하기" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Foreign Key 삭제하기</h3>
<ul>
<li>
<code class="language-plaintext highlighter-rouge">ALTER TABLE 테이블명 DROP FOREIGN KEY 제약이름;</code>의 구조로 작성</li>
<li>cf) MySQL말고 다른 DB에서는<code class="language-plaintext highlighter-rouge"> DROP CONSTRAINT</code>를 사용하기도 함</li>
</ul>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- review 테이블에 있는 'fk_review_table'이라는 Foreign Key 조건을 삭제</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">review</span>
    <span class="k">DROP</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="n">fk_review_table</span><span class="p">;</span>
</code></pre></div></div>
<h2 id="foreign-key-정책"> <a href="#foreign-key-%EC%A0%95%EC%B1%85" aria-labelledby="foreign-key-정책" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Foreign Key 정책</h2>
<h3 id="on-delete"> <a href="#on-delete" aria-labelledby="on-delete" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ON DELETE</h3>
<p>: 부모 테이블의 row가 삭제되는 경우에 대한 정책</p>
<ol>
<li>RESTRICT 정책<ul>
<li>자식 테이블의 row에 의해 참조되고 있는 부모 테이블의 row는 삭제 불가능</li>
<li>ex) course 테이블이 review 테이블에 의해 참조되고 있고, review 테이블에 course_id = 5인 row들이 존재할 때, course 테이블에서 id = 5인 row를 삭제하려고 하면 error 발생<br> <code class="language-plaintext highlighter-rouge">DELETE FROM course WHERE id = 5;</code>
</li>
<li>※ 해당 row를 참조하고 있는 자식 테이블의 row들을 모두 삭제한 후에야 삭제가 가능하다!</li>
<li>+) MySQL에서 ‘No Action’이라고 설정하는 것도 RESTRICT와 동일한 정책</li>
</ul>
</li>
<li>CASCADE 정책<ul>
<li>부모 테이블의 row를 삭제하면, 그 row를 참조하고 있던 자식 테이블의 row도 모두 함께 삭제됨</li>
<li>ex) course 테이블이 review 테이블에 의해 참조되고 있고, review 테이블에 course_id = 5인 row들이 존재할 때, course 테이블에서 id = 5인 row를 삭제하면 <br> 1) 정상적으로 삭제되고, 2) review 테이블에서 course_id = 5인 row들도 함께 삭제된다</li>
</ul>
</li>
<li>SET NULL 정책<ul>
<li>부모 테이블의 row를 삭제하면, 그 row를 참조하고 있던 자식 테이블의 row의 foreign_key 자리가 모두 NULL값으로 대체됨</li>
<li>ex) course 테이블이 review 테이블에 의해 참조되고 있고, review 테이블에 course_id = 5인 row들이 존재할 때, course 테이블에서 id = 5인 row를 삭제하면<br> 1) 정상적으로 삭제되고, 2) review 테이블에서 course_id = 5인 row들은 course_id가 NULL값으로 바뀐다</li>
</ul>
</li>
</ol>
<h3 id="on-update"> <a href="#on-update" aria-labelledby="on-update" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ON UPDATE</h3>
<p>: 부모 테이블의 row에서 참조되는 컬럼이 업데이트되는 경우에 대한 정책</p>
<ol>
<li>RESTRICT 정책<ul>
<li>부모 테이블의 row에서, 자식테이블의 row에 의해 참조되고 있는 컬럼은 업데이트 불가능</li>
<li>ex) course 테이블이 review 테이블에 의해 참조되고 있고, review 테이블에 course_id = 1인 row들이 존재할 때, course 테이블에서 id = 1인 row의 id를 100으로 업데이트하려고 하면 error 발생<br> <code class="language-plaintext highlighter-rouge">UPDATE course SET id = 100 WHERE id = 1;</code>
</li>
</ul>
</li>
<li>CASCADE 정책<ul>
<li>부모 테이블의 row에서, 자식테이블의 row에 의해 참조되고 있는 컬럼을 업데이트하면 이를 참조하던 자식 테이블 row의 foreign_key도 함께 업데이트됨</li>
<li>ex) course 테이블이 review 테이블에 의해 참조되고 있고, review 테이블에 course_id = 1인 row들이 존재할 때, course 테이블에서 id = 1인 row의 id를 100으로 업데이트하려고 하면 <br> 1) 정상적으로 업데이트되고, 2) review 테이블에서 course_id = 1인 row들도 다 course_id = 100으로 변경된다</li>
</ul>
</li>
<li>SET NULL 정책<ul>
<li>부모 테이블의 row에서, 자식테이블의 row에 의해 참조되고 있는 컬럼을 업데이트하면 이를 참조하던 자식 테이블 row의 foreign_key는 모두 NULL값으로 대체됨</li>
<li>ex) course 테이블이 review 테이블에 의해 참조되고 있고, review 테이블에 course_id = 1인 row들이 존재할 때, course 테이블에서 id = 1인 row의 id를 100으로 업데이트하려고 하면 <br> 1) 정상적으로 업데이트되고, 2) review 테이블에서 course_id = 1인 row들도 다 course_id가 NULL값으로 바뀐다</li>
</ul>
</li>
</ol>
<p class="fs-1 lh-0"> </p>
<p><strong>+) ON DELETE와 ON UPDATE를 서로 다른 정책으로 설정하는 것도 가능!</strong></p>
<ul><li>ex) ON DELETE RESTRICT &amp; ON UPDATE CASCADE</li></ul>
<h2 id="python에서-db-연결"> <a href="#python%EC%97%90%EC%84%9C-db-%EC%97%B0%EA%B2%B0" aria-labelledby="python에서-db-연결" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Python에서 DB 연결</h2>
<h3 id="pymysql"> <a href="#pymysql" aria-labelledby="pymysql" class="anchor-heading"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PyMySQL</h3>
<p>: python에서 MySQL 데이터베이스에 연결할 수 있게 해주는 library.</p>
<ul><li>
<code class="language-plaintext highlighter-rouge">pip install pymsql</code>로 설치해서 사용</li></ul>
<ol>
<li>데이터베이스와 연결하기<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kn">import</span> <span class="nn">pymysql</span>  <span class="c1"># import해서 사용
</span>
 <span class="n">conn</span> <span class="o">=</span> <span class="n">pymysql</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s">'root'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">'password'</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s">'database'</span><span class="p">)</span>
 <span class="n">curs</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">pymysql</span><span class="p">.</span><span class="n">cursors</span><span class="p">.</span><span class="n">DictCursor</span><span class="p">)</span>
</code></pre></div></div>
</li>
<li>테이블 생성하기<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># curs.execute() 안에 원하는 SQL문을 써주면 된다
</span> <span class="n">curs</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'''CREATE TABLE IF NOT EXISTS `users` (
                 id INT NOT NULL AUTO_INCREMENT,
                 name VARCHAR(50) NOT NULL,
                 follower_count INT NULL
                 PRIMARY KEY (id));'''</span><span class="p">)</span>

 <span class="n">conn</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c1"># commit을 해야 DB에 반영됨
</span></code></pre></div></div>
</li>
<li>데이터 INSERT<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># 아래와 같이 f string을 써서 SQL문을 구성하는 것도 가능
</span> <span class="n">curs</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s">"""INSERT INTO users (name, follower_count)
                 VALUES ('</span><span class="si">{</span><span class="n">artist_name</span><span class="si">}</span><span class="s">', </span><span class="si">{</span><span class="n">artist_follower_count</span><span class="si">}</span><span class="s">);"""</span><span class="p">)</span>

 <span class="n">conn</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>
</code></pre></div></div>
<ul><li>그 외, 데이터 삭제/업데이트 등도 그냥 <code class="language-plaintext highlighter-rouge">cusr.execute("SQL문")</code>으로 적어준 후 <code class="language-plaintext highlighter-rouge">conn.commit()</code>하면 DB에 반영된다</li></ul>
</li>
<li>데이터 SELECT<ul>
<li>
<p><code class="language-plaintext highlighter-rouge">curs.fetchall()</code>을 사용하면 SELECT문으로 가져온 데이터 전체를 한 번에 읽어올 수 있다</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">curs</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * FROM users WHERE follower_count &gt; 10'</span><span class="p">)</span>

  <span class="n">curs</span><span class="p">.</span><span class="n">fetchall</span><span class="p">()</span>
</code></pre></div></div>
</li>
<li>
<p><code class="language-plaintext highlighter-rouge">curs.fetchone()</code>을 사용하면 SELECT문으로 가져온 데이터를 한 줄 한 줄 읽어오게 된다<br> (*주로 한 줄만 읽어오면 될 때 사용)</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">curs</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * FROM users ORDER BY follower_count DESC LIMIT 1'</span><span class="p">)</span>

  <span class="n">curs</span><span class="p">.</span><span class="n">fetchone</span><span class="p">()</span>
</code></pre></div></div>
</li>
</ul>
</li>
<li>데이터베이스 연결 닫기<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># 원하는 작업을 모두 수행한 후에 close로 닫아주면 된다
</span> <span class="n">conn</span><span class="p">.</span><span class="n">close</span>
</code></pre></div></div>
</li>
</ol>
<hr>
<footer><p class="text-small text-grey-dk-000 mb-0">Copyright © 2021 Chaeyun.<br>This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a Jekyll theme.</p></footer>
</div>
</div>
<div class="search-overlay"></div>
</div>
</body>
</html>
